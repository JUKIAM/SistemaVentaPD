Ù~
fD:\Ingenier√≠a de Sistemas\Ingenier√≠a de Software II\SistemaDeVentaPassionDrummers\Datos\CD_Compra.cs
	namespace 	
Datos
 
{ 
public 

class 
	CD_Compra 
{ 
public 
int 
ObtenerCorrelativo %
(% &
)& '
{ 	
int 
IdCorrelativo 
= 
$num  !
;! "
using 
( 
SqlConnection  
	oconexion! *
=+ ,
new- 0
SqlConnection1 >
(> ?
Conexion? G
.G H
cadenaH N
)N O
)O P
{ 
try 
{ 
StringBuilder !
query" '
=( )
new* -
StringBuilder. ;
(; <
)< =
;= >
query 
. 

AppendLine $
($ %
$str% F
)F G
;G H

SqlCommand 
cmd "
=# $
new% (

SqlCommand) 3
(3 4
query4 9
.9 :
ToString: B
(B C
)C D
,D E
	oconexionF O
)O P
;P Q
cmd 
. 
CommandType #
=$ %
CommandType& 1
.1 2
Text2 6
;6 7
	oconexion 
. 
Open "
(" #
)# $
;$ %
IdCorrelativo !
=" #
Convert$ +
.+ ,
ToInt32, 3
(3 4
cmd4 7
.7 8
ExecuteScalar8 E
(E F
)F G
)G H
;H I
} 
catch   
(   
	Exception    
ex  ! #
)  # $
{!! 
IdCorrelativo"" !
=""" #
$num""$ %
;""% &
}## 
}$$ 
return&& 
IdCorrelativo&&  
;&&  !
}'' 	
public)) 
bool)) 
	Registrar)) 
()) 
Compra)) $
obj))% (
,))( )
	DataTable))* 3
DetalleCompra))4 A
,))A B
out))C F
String))G M
Mensaje))N U
)))U V
{** 	
bool++ 
	Respuesta++ 
=++ 
false++ "
;++" #
Mensaje,, 
=,, 
String,, 
.,, 
Empty,, "
;,," #
using.. 
(.. 
SqlConnection..  
	oconexion..! *
=..+ ,
new..- 0
SqlConnection..1 >
(..> ?
Conexion..? G
...G H
cadena..H N
)..N O
)..O P
{// 
try00 
{11 

SqlCommand22 
cmd22 "
=22# $
new22% (

SqlCommand22) 3
(223 4
$str224 H
,22H I
	oconexion22J S
)22S T
;22T U
cmd33 
.33 

Parameters33 "
.33" #
AddWithValue33# /
(33/ 0
$str330 ;
,33; <
obj33= @
.33@ A
oUsuario33A I
.33I J
Id33J L
)33L M
;33M N
cmd44 
.44 

Parameters44 "
.44" #
AddWithValue44# /
(44/ 0
$str440 =
,44= >
obj44? B
.44B C

oProveedor44C M
.44M N
Id44N P
)44P Q
;44Q R
cmd55 
.55 

Parameters55 "
.55" #
AddWithValue55# /
(55/ 0
$str550 ?
,55? @
obj55A D
.55D E
TipoDocumento55E R
)55R S
;55S T
cmd66 
.66 

Parameters66 "
.66" #
AddWithValue66# /
(66/ 0
$str660 A
,66A B
obj66C F
.66F G
NumeroDocumento66G V
)66V W
;66W X
cmd77 
.77 

Parameters77 "
.77" #
AddWithValue77# /
(77/ 0
$str770 <
,77< =
obj77> A
.77A B

MontoTotal77B L
)77L M
;77M N
cmd88 
.88 

Parameters88 "
.88" #
AddWithValue88# /
(88/ 0
$str880 ?
,88? @
DetalleCompra88A N
)88N O
;88O P
cmd99 
.99 

Parameters99 "
.99" #
Add99# &
(99& '
$str99' 2
,992 3
	SqlDbType994 =
.99= >
Int99> A
)99A B
.99B C
	Direction99C L
=99M N
ParameterDirection99O a
.99a b
Output99b h
;99h i
cmd:: 
.:: 

Parameters:: "
.::" #
Add::# &
(::& '
$str::' 0
,::0 1
	SqlDbType::2 ;
.::; <
VarChar::< C
,::C D
$num::E H
)::H I
.::I J
	Direction::J S
=::T U
ParameterDirection::V h
.::h i
Output::i o
;::o p
cmd;; 
.;; 
CommandType;; #
=;;$ %
CommandType;;& 1
.;;1 2
StoredProcedure;;2 A
;;;A B
	oconexion== 
.== 
Open== "
(==" #
)==# $
;==$ %
cmd>> 
.>> 
ExecuteNonQuery>> '
(>>' (
)>>( )
;>>) *
	Respuesta@@ 
=@@ 
Convert@@  '
.@@' (
	ToBoolean@@( 1
(@@1 2
cmd@@2 5
.@@5 6

Parameters@@6 @
[@@@ A
$str@@A L
]@@L M
.@@M N
Value@@N S
)@@S T
;@@T U
MensajeAA 
=AA 
cmdAA !
.AA! "

ParametersAA" ,
[AA, -
$strAA- 6
]AA6 7
.AA7 8
ValueAA8 =
.AA= >
ToStringAA> F
(AAF G
)AAG H
;AAH I
}CC 
catchDD 
(DD 
	ExceptionDD  
exDD! #
)DD# $
{EE 
	RespuestaFF 
=FF 
falseFF  %
;FF% &
MensajeGG 
=GG 
exGG  
.GG  !
MessageGG! (
;GG( )
}HH 
}II 
returnJJ 
	RespuestaJJ 
;JJ 
}KK 	
publicMM 
CompraMM 
ObtenerCompraMM #
(MM# $
StringMM$ *
numeroMM+ 1
)MM1 2
{NN 	
CompraOO 
objOO 
=OO 
newOO 
CompraOO #
(OO# $
)OO$ %
;OO% &
usingQQ 
(QQ 
SqlConnectionQQ  
	oconexionQQ! *
=QQ+ ,
newQQ- 0
SqlConnectionQQ1 >
(QQ> ?
ConexionQQ? G
.QQG H
cadenaQQH N
)QQN O
)QQO P
{RR 
trySS 
{TT 
StringBuilderUU !
queryUU" '
=UU( )
newUU* -
StringBuilderUU. ;
(UU; <
)UU< =
;UU= >
queryVV 
.VV 

AppendLineVV $
(VV$ %
$strVV% 9
)VV9 :
;VV: ;
queryWW 
.WW 

AppendLineWW $
(WW$ %
$strWW% 8
)WW8 9
;WW9 :
queryXX 
.XX 

AppendLineXX $
(XX$ %
$strXX% D
)XXD E
;XXE F
queryYY 
.YY 

AppendLineYY $
(YY$ %
$str	YY% è
)
YYè ê
;
YYê ë
queryZZ 
.ZZ 

AppendLineZZ $
(ZZ$ %
$strZZ% 4
)ZZ4 5
;ZZ5 6
query[[ 
.[[ 

AppendLine[[ $
([[$ %
$str[[% X
)[[X Y
;[[Y Z
query\\ 
.\\ 

AppendLine\\ $
(\\$ %
$str\\% `
)\\` a
;\\a b
query]] 
.]] 

AppendLine]] $
(]]$ %
$str]]% H
)]]H I
;]]I J

SqlCommand__ 
cmd__ "
=__# $
new__% (

SqlCommand__) 3
(__3 4
query__4 9
.__9 :
ToString__: B
(__B C
)__C D
,__D E
	oconexion__F O
)__O P
;__P Q
cmd`` 
.`` 

Parameters`` "
.``" #
AddWithValue``# /
(``/ 0
$str``0 9
,``9 :
numero``; A
)``A B
;``B C
cmdaa 
.aa 
CommandTypeaa #
=aa$ %
CommandTypeaa& 1
.aa1 2
Textaa2 6
;aa6 7
	oconexionbb 
.bb 
Openbb "
(bb" #
)bb# $
;bb$ %
usingdd 
(dd 
SqlDataReaderdd (
drdd) +
=dd, -
cmddd. 1
.dd1 2
ExecuteReaderdd2 ?
(dd? @
)dd@ A
)ddA B
{ee 
whileff 
(ff 
drff !
.ff! "
Readff" &
(ff& '
)ff' (
)ff( )
{gg 
objhh 
=hh  !
newhh" %
Comprahh& ,
(hh, -
)hh- .
{ii 
IdComprajj  (
=jj) *
Convertjj+ 2
.jj2 3
ToInt32jj3 :
(jj: ;
drjj; =
[jj= >
$strjj> H
]jjH I
)jjI J
,jjJ K
oUsuariokk  (
=kk) *
newkk+ .
Usuariokk/ 6
(kk6 7
)kk7 8
{kk9 :
NombreCompletokk; I
=kkJ K
drkkL N
[kkN O
$strkkO _
]kk_ `
.kk` a
ToStringkka i
(kki j
)kkj k
}kkl m
,kkm n

oProveedorll  *
=ll+ ,
newll- 0
	Proveedorll1 :
(ll: ;
)ll; <
{ll= >
	Documentoll? H
=llI J
drllK M
[llM N
$strllN Y
]llY Z
.llZ [
ToStringll[ c
(llc d
)lld e
,lle f
RazonSocialllg r
=lls t
drllu w
[llw x
$str	llx Ö
]
llÖ Ü
.
llÜ á
ToString
llá è
(
llè ê
)
llê ë
}
llí ì
,
llì î
TipoDocumentomm  -
=mm. /
drmm0 2
[mm2 3
$strmm3 B
]mmB C
.mmC D
ToStringmmD L
(mmL M
)mmM N
,mmN O
NumeroDocumentonn  /
=nn0 1
drnn2 4
[nn4 5
$strnn5 F
]nnF G
.nnG H
ToStringnnH P
(nnP Q
)nnQ R
,nnR S

MontoTotaloo  *
=oo+ ,
Convertoo- 4
.oo4 5
	ToDecimaloo5 >
(oo> ?
droo? A
[ooA B
$strooB N
]ooN O
.ooO P
ToStringooP X
(ooX Y
)ooY Z
)ooZ [
,oo[ \
FechaRegistropp  -
=pp. /
drpp0 2
[pp2 3
$strpp3 B
]ppB C
.ppC D
ToStringppD L
(ppL M
)ppM N
}qq 
;qq 
}rr 
}ss 
}uu 
catchvv 
(vv 
	Exceptionvv  
exvv! #
)vv# $
{ww 
objyy 
=yy 
newyy 
Comprayy $
(yy$ %
)yy% &
;yy& '
}zz 
}{{ 
return|| 
obj|| 
;|| 
}}} 	
public 
List 
< 
Detalle_Compra "
>" # 
ObtenerDetalleCompra$ 8
(8 9
int9 <
idCompra= E
)E F
{
ÄÄ 	
List
ÅÅ 
<
ÅÅ 
Detalle_Compra
ÅÅ 
>
ÅÅ  
oLista
ÅÅ! '
=
ÅÅ( )
new
ÅÅ* -
List
ÅÅ. 2
<
ÅÅ2 3
Detalle_Compra
ÅÅ3 A
>
ÅÅA B
(
ÅÅB C
)
ÅÅC D
;
ÅÅD E
try
ÇÇ 
{
ÉÉ 
using
ÑÑ 
(
ÑÑ 
SqlConnection
ÑÑ $
	oconexion
ÑÑ% .
=
ÑÑ/ 0
new
ÑÑ1 4
SqlConnection
ÑÑ5 B
(
ÑÑB C
Conexion
ÑÑC K
.
ÑÑK L
cadena
ÑÑL R
)
ÑÑR S
)
ÑÑS T
{
ÖÖ 
	oconexion
ÜÜ 
.
ÜÜ 
Open
ÜÜ "
(
ÜÜ" #
)
ÜÜ# $
;
ÜÜ$ %
StringBuilder
áá !
query
áá" '
=
áá( )
new
áá* -
StringBuilder
áá. ;
(
áá; <
)
áá< =
;
áá= >
query
ââ 
.
ââ 

AppendLine
ââ $
(
ââ$ %
$str
ââ% z
)
ââz {
;
ââ{ |
query
ää 
.
ää 

AppendLine
ää $
(
ää$ %
$str
ää% \
)
ää\ ]
;
ää] ^
query
ãã 
.
ãã 

AppendLine
ãã $
(
ãã$ %
$str
ãã% D
)
ããD E
;
ããE F

SqlCommand
çç 
cmd
çç "
=
çç# $
new
çç% (

SqlCommand
çç) 3
(
çç3 4
query
çç4 9
.
çç9 :
ToString
çç: B
(
ççB C
)
ççC D
,
ççD E
	oconexion
ççF O
)
ççO P
;
ççP Q
cmd
éé 
.
éé 

Parameters
éé "
.
éé" #
AddWithValue
éé# /
(
éé/ 0
$str
éé0 ;
,
éé; <
idCompra
éé= E
)
ééE F
;
ééF G
cmd
èè 
.
èè 
CommandType
èè #
=
èè$ %
System
èè& ,
.
èè, -
Data
èè- 1
.
èè1 2
CommandType
èè2 =
.
èè= >
Text
èè> B
;
èèB C
using
ëë 
(
ëë 
SqlDataReader
ëë (
dr
ëë) +
=
ëë, -
cmd
ëë. 1
.
ëë1 2
ExecuteReader
ëë2 ?
(
ëë? @
)
ëë@ A
)
ëëA B
{
íí 
while
ìì 
(
ìì 
dr
ìì !
.
ìì! "
Read
ìì" &
(
ìì& '
)
ìì' (
)
ìì( )
{
îî 
oLista
ïï "
.
ïï" #
Add
ïï# &
(
ïï& '
new
ïï' *
Detalle_Compra
ïï+ 9
(
ïï9 :
)
ïï: ;
{
ññ 
	oProducto
óó  )
=
óó* +
new
óó, /
Producto
óó0 8
(
óó8 9
)
óó9 :
{
óó; <
Nombre
óó= C
=
óóD E
dr
óóF H
[
óóH I
$str
óóI Q
]
óóQ R
.
óóR S
ToString
óóS [
(
óó[ \
)
óó\ ]
}
óó^ _
,
óó_ `
PrecioCompra
òò  ,
=
òò- .
Convert
òò/ 6
.
òò6 7
	ToDecimal
òò7 @
(
òò@ A
dr
òòA C
[
òòC D
$str
òòD R
]
òòR S
.
òòS T
ToString
òòT \
(
òò\ ]
)
òò] ^
)
òò^ _
,
òò_ `
Cantidad
ôô  (
=
ôô) *
Convert
ôô+ 2
.
ôô2 3
ToInt32
ôô3 :
(
ôô: ;
dr
ôô; =
[
ôô= >
$str
ôô> H
]
ôôH I
.
ôôI J
ToString
ôôJ R
(
ôôR S
)
ôôS T
)
ôôT U
,
ôôU V

MontoTotal
öö  *
=
öö+ ,
Convert
öö- 4
.
öö4 5
	ToDecimal
öö5 >
(
öö> ?
dr
öö? A
[
ööA B
$str
ööB N
]
ööN O
.
ööO P
ToString
ööP X
(
ööX Y
)
ööY Z
)
ööZ [
,
öö[ \
}
õõ 
)
õõ 
;
õõ 
}
úú 
}
ùù 
}
ûû 
}
üü 
catch
†† 
(
†† 
	Exception
†† 
ex
†† 
)
††  
{
°° 
oLista
¢¢ 
=
¢¢ 
new
¢¢ 
List
¢¢ !
<
¢¢! "
Detalle_Compra
¢¢" 0
>
¢¢0 1
(
¢¢1 2
)
¢¢2 3
;
¢¢3 4
}
££ 
return
§§ 
oLista
§§ 
;
§§ 
}
•• 	
}
¶¶ 
}ßß Õæ
gD:\Ingenier√≠a de Sistemas\Ingenier√≠a de Software II\SistemaDeVentaPassionDrummers\Datos\CD_Grafica.cs
	namespace 	
Datos
 
{ 
public 

class 

CD_Grafica 
{ 
public 
struct 
IngresosPorFecha &
{ 	
public 
String 
Fecha 
{  !
get" %
;% &
set' *
;* +
}, -
public 
Decimal 
cantidadTotal (
{) *
get+ .
;. /
set0 3
;3 4
}5 6
} 	
public 
DateTime 
fechaInicio #
{$ %
get& )
;) *
set+ .
;. /
}0 1
public 
DateTime 
fechaFin  
{! "
get# &
;& '
set( +
;+ ,
}- .
public 
int 

NumeroDias 
{ 
get  #
;# $
set% (
;( )
}* +
public 
int 
NumeroClientes !
{" #
get$ '
;' (
set) ,
;, -
}. /
public 
int 
NumeroProveedores $
{% &
get' *
;* +
set, /
;/ 0
}1 2
public 
int 
NumeroProductos "
{# $
get% (
;( )
set* -
;- .
}/ 0
public 
List 
< 
KeyValuePair  
<  !
String! '
,' (
int) ,
>, -
>- . 
ProductosMasVendidos/ C
{D E
getF I
;I J
setK N
;N O
}P Q
public 
List 
< 
KeyValuePair  
<  !
String! '
,' (
int) ,
>, -
>- .
ProductosBajoStock/ A
{B C
getD G
;G H
setI L
;L M
}N O
public 
List 
< 
IngresosPorFecha $
>$ %
ListaIngresosBrutos& 9
{: ;
get< ?
;? @
setA D
;D E
}F G
public   
int   
NumeroVentas   
{    !
get  " %
;  % &
set  ' *
;  * +
}  , -
public!! 
Decimal!! 
TotalIngresos!! $
{!!% &
get!!' *
;!!* +
set!!, /
;!!/ 0
}!!1 2
public"" 
Decimal"" 
TotalGanancias"" %
{""& '
get""( +
;""+ ,
set""- 0
;""0 1
}""2 3
public%% 
void%% "
ObtenerNumeroElementos%% *
(%%* +
)%%+ ,
{&& 	
using)) 
()) 
SqlConnection))  
	oconexion))! *
=))+ ,
new))- 0
SqlConnection))1 >
())> ?
Conexion))? G
.))G H
cadena))H N
)))N O
)))O P
{** 
	oconexion++ 
.++ 
Open++ 
(++ 
)++  
;++  !
using-- 
(-- 
var-- 
cmd-- 
=--  
new--! $

SqlCommand--% /
(--/ 0
)--0 1
)--1 2
{.. 
cmd// 
.// 

Connection// "
=//# $
	oconexion//% .
;//. /
cmd22 
.22 
CommandText22 #
=22$ %
$str22& L
;22L M
NumeroClientes33 "
=33# $
(33% &
int33& )
)33) *
cmd33* -
.33- .
ExecuteScalar33. ;
(33; <
)33< =
;33= >
cmd77 
.77 
CommandText77 #
=77$ %
$str77& P
;77P Q
NumeroProveedores88 %
=88& '
(88( )
int88) ,
)88, -
cmd88- 0
.880 1
ExecuteScalar881 >
(88> ?
)88? @
;88@ A
cmd;; 
.;; 
CommandText;; #
=;;$ %
$str;;& N
;;;N O
NumeroProductos<< #
=<<$ %
(<<& '
int<<' *
)<<* +
cmd<<+ .
.<<. /
ExecuteScalar<</ <
(<<< =
)<<= >
;<<> ?
StringBuilder== !
query==" '
===( )
new==* -
StringBuilder==. ;
(==; <
)==< =
;=== >
query>> 
.>> 

AppendLine>> $
(>>$ %
$str>>% G
)>>G H
;>>H I
query?? 
.?? 

AppendLine?? $
(??$ %
$str??% ^
)??^ _
;??_ `

SqlCommandAA 
cmd2AA #
=AA$ %
newAA& )

SqlCommandAA* 4
(AA4 5
queryAA5 :
.AA: ;
ToStringAA; C
(AAC D
)AAD E
,AAE F
	oconexionAAG P
)AAP Q
;AAQ R
cmd2BB 
.BB 

ParametersBB #
.BB# $
AddWithValueBB$ 0
(BB0 1
$strBB1 >
,BB> ?
fechaInicioBB@ K
)BBK L
;BBL M
cmd2CC 
.CC 

ParametersCC #
.CC# $
AddWithValueCC$ 0
(CC0 1
$strCC1 >
,CC> ?
fechaFinCC@ H
)CCH I
;CCI J
cmd2DD 
.DD 
CommandTypeDD $
=DD% &
CommandTypeDD' 2
.DD2 3
TextDD3 7
;DD7 8
NumeroVentasEE  
=EE! "
(EE# $
intEE$ '
)EE' (
cmd2EE( ,
.EE, -
ExecuteScalarEE- :
(EE: ;
)EE; <
;EE< =
}FF 
}GG 
}HH 	
publicJJ 
voidJJ !
ObtenerAnalisisVentasJJ )
(JJ) *
)JJ* +
{KK 	
ListaIngresosBrutosLL 
=LL  !
newLL" %
ListLL& *
<LL* +
IngresosPorFechaLL+ ;
>LL; <
(LL< =
)LL= >
;LL> ?
TotalGananciasMM 
=MM 
$numMM 
;MM 
TotalIngresosNN 
=NN 
$numNN 
;NN 
usingQQ 
(QQ 
SqlConnectionQQ  
	oconexionQQ! *
=QQ+ ,
newQQ- 0
SqlConnectionQQ1 >
(QQ> ?
ConexionQQ? G
.QQG H
cadenaQQH N
)QQN O
)QQO P
{RR 
	oconexionSS 
.SS 
OpenSS 
(SS 
)SS  
;SS  !
usingUU 
(UU 
varUU 
cmdUU 
=UU  
newUU! $

SqlCommandUU% /
(UU/ 0
)UU0 1
)UU1 2
{VV 
cmdWW 
.WW 

ConnectionWW "
=WW# $
	oconexionWW% .
;WW. /
StringBuilderXX !
queryXX" '
=XX( )
newXX* -
StringBuilderXX. ;
(XX; <
)XX< =
;XX= >
queryYY 
.YY 

AppendLineYY $
(YY$ %
$strYY% L
)YYL M
;YYM N
queryZZ 
.ZZ 

AppendLineZZ $
(ZZ$ %
$strZZ% 1
)ZZ1 2
;ZZ2 3
query[[ 
.[[ 

AppendLine[[ $
([[$ %
$str[[% ^
)[[^ _
;[[_ `
query\\ 
.\\ 

AppendLine\\ $
(\\$ %
$str\\% =
)\\= >
;\\> ?

SqlCommand^^ 
cmd2^^ #
=^^$ %
new^^& )

SqlCommand^^* 4
(^^4 5
query^^5 :
.^^: ;
ToString^^; C
(^^C D
)^^D E
,^^E F
	oconexion^^G P
)^^P Q
;^^Q R
cmd2__ 
.__ 

Parameters__ #
.__# $
AddWithValue__$ 0
(__0 1
$str__1 >
,__> ?
fechaInicio__@ K
)__K L
;__L M
cmd2`` 
.`` 

Parameters`` #
.``# $
AddWithValue``$ 0
(``0 1
$str``1 >
,``> ?
fechaFin``@ H
)``H I
;``I J
cmd2aa 
.aa 
CommandTypeaa $
=aa% &
CommandTypeaa' 2
.aa2 3
Textaa3 7
;aa7 8
varcc 
readercc 
=cc  
cmd2cc! %
.cc% &
ExecuteReadercc& 3
(cc3 4
)cc4 5
;cc5 6
vardd 
resultadoTabladd &
=dd' (
newdd) ,
Listdd- 1
<dd1 2
KeyValuePairdd2 >
<dd> ?
DateTimedd? G
,ddG H
decimalddI P
>ddP Q
>ddQ R
(ddR S
)ddS T
;ddT U
whileee 
(ee 
readeree !
.ee! "
Readee" &
(ee& '
)ee' (
)ee( )
{ff 
resultadoTablagg &
.gg& '
Addgg' *
(gg* +
newhh 
KeyValuePairhh  ,
<hh, -
DateTimehh- 5
,hh5 6
decimalhh7 >
>hh> ?
(hh? @
(hh@ A
DateTimehhA I
)hhI J
readerhhJ P
[hhP Q
$numhhQ R
]hhR S
,hhS T
(hhU V
decimalhhV ]
)hh] ^
readerhh^ d
[hhd e
$numhhe f
]hhf g
)hhg h
)ii 
;ii 
TotalIngresosjj %
+=jj& (
(jj) *
decimaljj* 1
)jj1 2
(jj2 3
readerjj3 9
[jj9 :
$numjj: ;
]jj; <
)jj< =
;jj= >
}kk 
TotalGananciasll "
=ll# $
TotalIngresosll% 2
*ll3 4
(ll5 6
decimalll6 =
)ll= >
$numll> A
;llA B
readermm 
.mm 
Closemm  
(mm  !
)mm! "
;mm" #
ifpp 
(pp 

NumeroDiaspp "
<=pp# %
$numpp& (
)pp( )
{qq 
foreachrr 
(rr  !
varrr! $
itemrr% )
inrr* ,
resultadoTablarr- ;
)rr; <
{ss 
ListaIngresosBrutostt /
.tt/ 0
Addtt0 3
(tt3 4
newtt4 7
IngresosPorFechatt8 H
(ttH I
)ttI J
{uu 
Fechavv  %
=vv& '
itemvv( ,
.vv, -
Keyvv- 0
.vv0 1
ToStringvv1 9
(vv9 :
$strvv: B
)vvB C
,vvC D
cantidadTotalww  -
=ww. /
itemww0 4
.ww4 5
Valueww5 :
}xx 
)xx 
;xx 
}yy 
}zz 
else}} 
if}} 
(}} 

NumeroDias}} '
<=}}( *
$num}}+ -
)}}- .
{~~ 
ListaIngresosBrutos +
=, -
(. /
from/ 3

listaVenta4 >
in? A
resultadoTablaB P
group
ÄÄ/ 4

listaVenta
ÄÄ5 ?
by
ÄÄ@ B
CultureInfo
ÄÄC N
.
ÄÄN O
CurrentCulture
ÄÄO ]
.
ÄÄ] ^
Calendar
ÄÄ^ f
.
ÄÄf g
GetWeekOfYear
ÄÄg t
(
ÄÄt u

listaVenta
ÅÅ3 =
.
ÅÅ= >
Key
ÅÅ> A
,
ÅÅA B
CalendarWeekRule
ÅÅC S
.
ÅÅS T
FirstDay
ÅÅT \
,
ÅÅ\ ]
	DayOfWeek
ÅÅ^ g
.
ÅÅg h
Monday
ÅÅh n
)
ÅÅn o
into
ÇÇ3 7
venta
ÇÇ8 =
select
ÉÉ/ 5
new
ÉÉ6 9
IngresosPorFecha
ÉÉ: J
{
ÑÑ/ 0
Fecha
ÖÖ3 8
=
ÖÖ9 :
$str
ÖÖ; D
+
ÖÖE F
venta
ÖÖG L
.
ÖÖL M
Key
ÖÖM P
.
ÖÖP Q
ToString
ÖÖQ Y
(
ÖÖY Z
)
ÖÖZ [
,
ÖÖ[ \
cantidadTotal
ÜÜ3 @
=
ÜÜA B
venta
ÜÜC H
.
ÜÜH I
Sum
ÜÜI L
(
ÜÜL M
cantidad
ÜÜM U
=>
ÜÜV X
cantidad
ÜÜY a
.
ÜÜa b
Value
ÜÜb g
)
ÜÜg h
}
áá/ 0
)
áá0 1
.
áá1 2
ToList
áá2 8
(
áá8 9
)
áá9 :
;
áá: ;
}
àà 
else
ãã 
if
ãã 
(
ãã 

NumeroDias
ãã '
<=
ãã( *
(
ãã+ ,
$num
ãã, /
*
ãã0 1
$num
ãã2 3
)
ãã3 4
)
ãã4 5
{
åå 
bool
çç 
esA√±o
çç "
=
çç# $

NumeroDias
çç% /
<=
çç0 2
$num
çç3 6
;
çç6 7!
ListaIngresosBrutos
éé +
=
éé, -
(
éé. /
from
éé/ 3

listaVenta
éé4 >
in
éé? A
resultadoTabla
ééB P
group
èè/ 4

listaVenta
èè5 ?
by
èè@ B

listaVenta
èèC M
.
èèM N
Key
èèN Q
.
èèQ R
ToString
èèR Z
(
èèZ [
$str
èè[ e
)
èèe f
into
êê3 7
venta
êê8 =
select
ëë/ 5
new
ëë6 9
IngresosPorFecha
ëë: J
{
íí/ 0
Fecha
ìì3 8
=
ìì9 :
esA√±o
ìì; @
?
ììA B
venta
ììC H
.
ììH I
Key
ììI L
.
ììL M
	Substring
ììM V
(
ììV W
$num
ììW X
,
ììX Y
venta
ììZ _
.
ìì_ `
Key
ìì` c
.
ììc d
IndexOf
ììd k
(
ììk l
$str
ììl o
)
ììo p
)
ììp q
:
ììr s
venta
ììt y
.
ììy z
Key
ììz }
,
ìì} ~
cantidadTotal
îî3 @
=
îîA B
venta
îîC H
.
îîH I
Sum
îîI L
(
îîL M
cantidad
îîM U
=>
îîV X
cantidad
îîY a
.
îîa b
Value
îîb g
)
îîg h
}
ïï/ 0
)
ïï0 1
.
ïï1 2
ToList
ïï2 8
(
ïï8 9
)
ïï9 :
;
ïï: ;
}
ññ 
else
ôô 
{
öö !
ListaIngresosBrutos
õõ +
=
õõ, -
(
õõ. /
from
õõ/ 3

listaVenta
õõ4 >
in
õõ? A
resultadoTabla
õõB P
group
úú/ 4

listaVenta
úú5 ?
by
úú@ B

listaVenta
úúC M
.
úúM N
Key
úúN Q
.
úúQ R
ToString
úúR Z
(
úúZ [
$str
úú[ a
)
úúa b
into
ùù3 7
venta
ùù8 =
select
ûû/ 5
new
ûû6 9
IngresosPorFecha
ûû: J
{
üü/ 0
Fecha
††3 8
=
††9 :
venta
††; @
.
††@ A
Key
††A D
,
††D E
cantidadTotal
°°3 @
=
°°A B
venta
°°C H
.
°°H I
Sum
°°I L
(
°°L M
cantidad
°°M U
=>
°°V X
cantidad
°°Y a
.
°°a b
Value
°°b g
)
°°g h
}
¢¢/ 0
)
¢¢0 1
.
¢¢1 2
ToList
¢¢2 8
(
¢¢8 9
)
¢¢9 :
;
¢¢: ;
}
££ 
}
§§ 
}
•• 
}
¶¶ 	
public
®® 
void
®® &
ObtenerAnalisisProductos
®® ,
(
®®, -
)
®®- .
{
©© 	"
ProductosMasVendidos
™™  
=
™™! "
new
™™# &
List
™™' +
<
™™+ ,
KeyValuePair
™™, 8
<
™™8 9
string
™™9 ?
,
™™? @
int
™™A D
>
™™D E
>
™™E F
(
™™F G
)
™™G H
;
™™H I 
ProductosBajoStock
´´ 
=
´´  
new
´´! $
List
´´% )
<
´´) *
KeyValuePair
´´* 6
<
´´6 7
string
´´7 =
,
´´= >
int
´´? B
>
´´B C
>
´´C D
(
´´D E
)
´´E F
;
´´F G
using
≠≠ 
(
≠≠ 
SqlConnection
≠≠  
	oconexion
≠≠! *
=
≠≠+ ,
new
≠≠- 0
SqlConnection
≠≠1 >
(
≠≠> ?
Conexion
≠≠? G
.
≠≠G H
cadena
≠≠H N
)
≠≠N O
)
≠≠O P
{
ÆÆ 
	oconexion
ØØ 
.
ØØ 
Open
ØØ 
(
ØØ 
)
ØØ  
;
ØØ  !
StringBuilder
±± 
query
±± #
=
±±$ %
new
±±& )
StringBuilder
±±* 7
(
±±7 8
)
±±8 9
;
±±9 :
query
≤≤ 
.
≤≤ 

AppendLine
≤≤  
(
≤≤  !
$str
≤≤! Z
)
≤≤Z [
;
≤≤[ \
query
≥≥ 
.
≥≥ 

AppendLine
≥≥  
(
≥≥  !
$str
≥≥! 5
)
≥≥5 6
;
≥≥6 7
query
¥¥ 
.
¥¥ 

AppendLine
¥¥  
(
¥¥  !
$str
¥¥! c
)
¥¥c d
;
¥¥d e
query
µµ 
.
µµ 

AppendLine
µµ  
(
µµ  !
$str
µµ! Z
)
µµZ [
;
µµ[ \
query
∂∂ 
.
∂∂ 

AppendLine
∂∂  
(
∂∂  !
$str
∂∂! \
)
∂∂\ ]
;
∂∂] ^
query
∑∑ 
.
∑∑ 

AppendLine
∑∑  
(
∑∑  !
$str
∑∑! 4
)
∑∑4 5
;
∑∑5 6
query
∏∏ 
.
∏∏ 

AppendLine
∏∏  
(
∏∏  !
$str
∏∏! 2
)
∏∏2 3
;
∏∏3 4

SqlCommand
∫∫ 
cmd
∫∫ 
=
∫∫  
new
∫∫! $

SqlCommand
∫∫% /
(
∫∫/ 0
query
∫∫0 5
.
∫∫5 6
ToString
∫∫6 >
(
∫∫> ?
)
∫∫? @
,
∫∫@ A
	oconexion
∫∫B K
)
∫∫K L
;
∫∫L M
cmd
ªª 
.
ªª 

Parameters
ªª 
.
ªª 
AddWithValue
ªª +
(
ªª+ ,
$str
ªª, 9
,
ªª9 :
fechaInicio
ªª; F
)
ªªF G
;
ªªG H
cmd
ºº 
.
ºº 

Parameters
ºº 
.
ºº 
AddWithValue
ºº +
(
ºº+ ,
$str
ºº, 9
,
ºº9 :
fechaFin
ºº; C
)
ººC D
;
ººD E
cmd
ΩΩ 
.
ΩΩ 
CommandType
ΩΩ 
=
ΩΩ  !
CommandType
ΩΩ" -
.
ΩΩ- .
Text
ΩΩ. 2
;
ΩΩ2 3
using
øø 
(
øø 
SqlDataReader
øø $
dr
øø% '
=
øø( )
cmd
øø* -
.
øø- .
ExecuteReader
øø. ;
(
øø; <
)
øø< =
)
øø= >
{
¿¿ 
while
¡¡ 
(
¡¡ 
dr
¡¡ 
.
¡¡ 
Read
¡¡ "
(
¡¡" #
)
¡¡# $
)
¡¡$ %
{
¬¬ "
ProductosMasVendidos
√√ ,
.
√√, -
Add
√√- 0
(
√√0 1
new
ƒƒ 
KeyValuePair
ƒƒ (
<
ƒƒ( )
string
ƒƒ) /
,
ƒƒ/ 0
int
ƒƒ1 4
>
ƒƒ4 5
(
ƒƒ5 6
dr
ƒƒ6 8
[
ƒƒ8 9
$num
ƒƒ9 :
]
ƒƒ: ;
.
ƒƒ; <
ToString
ƒƒ< D
(
ƒƒD E
)
ƒƒE F
,
ƒƒF G
(
ƒƒH I
int
ƒƒI L
)
ƒƒL M
dr
ƒƒM O
[
ƒƒO P
$num
ƒƒP Q
]
ƒƒQ R
)
ƒƒR S
)
ƒƒS T
;
ƒƒT U
}
≈≈ 
}
∆∆ 
StringBuilder
»» 
query1
»» $
=
»»% &
new
»»' *
StringBuilder
»»+ 8
(
»»8 9
)
»»9 :
;
»»: ;
query1
…… 
.
…… 

AppendLine
…… !
(
……! "
$str
……" 8
)
……8 9
;
……9 :
query1
   
.
   

AppendLine
   !
(
  ! "
$str
  " 1
)
  1 2
;
  2 3
query1
ÀÀ 
.
ÀÀ 

AppendLine
ÀÀ !
(
ÀÀ! "
$str
ÀÀ" C
)
ÀÀC D
;
ÀÀD E

SqlCommand
ÕÕ 
cmd1
ÕÕ 
=
ÕÕ  !
new
ÕÕ" %

SqlCommand
ÕÕ& 0
(
ÕÕ0 1
query1
ÕÕ1 7
.
ÕÕ7 8
ToString
ÕÕ8 @
(
ÕÕ@ A
)
ÕÕA B
,
ÕÕB C
	oconexion
ÕÕD M
)
ÕÕM N
;
ÕÕN O
cmd1
ŒŒ 
.
ŒŒ 
CommandType
ŒŒ  
=
ŒŒ! "
CommandType
ŒŒ# .
.
ŒŒ. /
Text
ŒŒ/ 3
;
ŒŒ3 4
using
–– 
(
–– 
SqlDataReader
–– $
dr
––% '
=
––( )
cmd1
––* .
.
––. /
ExecuteReader
––/ <
(
––< =
)
––= >
)
––> ?
{
—— 
while
““ 
(
““ 
dr
““ 
.
““ 
Read
““ "
(
““" #
)
““# $
)
““$ %
{
””  
ProductosBajoStock
‘‘ *
.
‘‘* +
Add
‘‘+ .
(
‘‘. /
new
’’ 
KeyValuePair
’’ (
<
’’( )
string
’’) /
,
’’/ 0
int
’’1 4
>
’’4 5
(
’’5 6
dr
’’6 8
[
’’8 9
$num
’’9 :
]
’’: ;
.
’’; <
ToString
’’< D
(
’’D E
)
’’E F
,
’’F G
(
’’H I
int
’’I L
)
’’L M
dr
’’M O
[
’’O P
$num
’’P Q
]
’’Q R
)
’’R S
)
’’S T
;
’’T U
}
÷÷ 
}
◊◊ 
}
ÿÿ 
}
ŸŸ 	
public
€€ 
bool
€€ 
CargarDatos
€€ 
(
€€  
DateTime
€€  (
fechaInicio
€€) 4
,
€€4 5
DateTime
€€6 >
fechaFin
€€? G
)
€€G H
{
‹‹ 	
fechaFin
ﬁﬁ 
=
ﬁﬁ 
new
ﬁﬁ 
DateTime
ﬁﬁ #
(
ﬁﬁ# $
fechaFin
ﬁﬁ$ ,
.
ﬁﬁ, -
Year
ﬁﬁ- 1
,
ﬁﬁ1 2
fechaFin
ﬁﬁ3 ;
.
ﬁﬁ; <
Month
ﬁﬁ< A
,
ﬁﬁA B
fechaFin
ﬁﬁC K
.
ﬁﬁK L
Day
ﬁﬁL O
,
ﬁﬁO P
fechaFin
ﬁﬁQ Y
.
ﬁﬁY Z
Hour
ﬁﬁZ ^
,
ﬁﬁ^ _
fechaFin
ﬁﬁ` h
.
ﬁﬁh i
Minute
ﬁﬁi o
,
ﬁﬁo p
$num
ﬁﬁq s
)
ﬁﬁs t
;
ﬁﬁt u
if
ﬂﬂ 
(
ﬂﬂ 
fechaInicio
ﬂﬂ 
!=
ﬂﬂ 
this
ﬂﬂ #
.
ﬂﬂ# $
fechaInicio
ﬂﬂ$ /
||
ﬂﬂ0 2
fechaFin
ﬂﬂ3 ;
!=
ﬂﬂ< >
this
ﬂﬂ? C
.
ﬂﬂC D
fechaFin
ﬂﬂD L
)
ﬂﬂL M
{
‡‡ 
this
·· 
.
·· 
fechaInicio
··  
=
··! "
fechaInicio
··# .
;
··. /
this
‚‚ 
.
‚‚ 
fechaFin
‚‚ 
=
‚‚ 
fechaFin
‚‚  (
;
‚‚( )
this
„„ 
.
„„ 

NumeroDias
„„ 
=
„„  !
(
„„" #
fechaFin
„„# +
-
„„, -
fechaInicio
„„. 9
)
„„9 :
.
„„: ;
Days
„„; ?
;
„„? @$
ObtenerNumeroElementos
ÂÂ &
(
ÂÂ& '
)
ÂÂ' (
;
ÂÂ( )&
ObtenerAnalisisProductos
ÊÊ (
(
ÊÊ( )
)
ÊÊ) *
;
ÊÊ* +#
ObtenerAnalisisVentas
ÁÁ %
(
ÁÁ% &
)
ÁÁ& '
;
ÁÁ' (
Console
ÈÈ 
.
ÈÈ 
	WriteLine
ÈÈ !
(
ÈÈ! "
$str
ÈÈ" A
,
ÈÈA B
fechaInicio
ÈÈC N
.
ÈÈN O
ToString
ÈÈO W
(
ÈÈW X
)
ÈÈX Y
,
ÈÈY Z
fechaFin
ÈÈ[ c
.
ÈÈc d
ToString
ÈÈd l
(
ÈÈl m
)
ÈÈm n
)
ÈÈn o
;
ÈÈo p
return
ÍÍ 
true
ÍÍ 
;
ÍÍ 
}
ÎÎ 
else
ÏÏ 
{
ÌÌ 
Console
ÓÓ 
.
ÓÓ 
	WriteLine
ÓÓ !
(
ÓÓ! "
$str
ÓÓ" Z
,
ÓÓZ [
fechaInicio
ÓÓ\ g
.
ÓÓg h
ToString
ÓÓh p
(
ÓÓp q
)
ÓÓq r
,
ÓÓr s
fechaFin
ÓÓt |
.
ÓÓ| }
ToStringÓÓ} Ö
(ÓÓÖ Ü
)ÓÓÜ á
)ÓÓá à
;ÓÓà â
return
ÔÔ 
false
ÔÔ 
;
ÔÔ 
}
 
}
ÒÒ 	
}
ÚÚ 
}ÛÛ √W
gD:\Ingenier√≠a de Sistemas\Ingenier√≠a de Software II\SistemaDeVentaPassionDrummers\Datos\CD_Negocio.cs
	namespace 	
Datos
 
{ 
public 

class 

CD_Negocio 
{ 
public 
Negocio 
ObtenerDatos #
(# $
)$ %
{ 	
Negocio 
obj 
= 
new 
Negocio %
(% &
)& '
;' (
try 
{ 
using 
( 
SqlConnection $
conexion% -
=. /
new0 3
SqlConnection4 A
(A B
ConexionB J
.J K
cadenaK Q
)Q R
)R S
{ 
conexion 
. 
Open !
(! "
)" #
;# $
String 
query  
=! "
$str# n
;n o

SqlCommand 
cmd "
=# $
new% (

SqlCommand) 3
(3 4
query4 9
,9 :
conexion; C
)C D
;D E
cmd 
. 
CommandType #
=$ %
CommandType& 1
.1 2
Text2 6
;6 7
using 
( 
SqlDataReader (
dr) +
=, -
cmd. 1
.1 2
ExecuteReader2 ?
(? @
)@ A
)A B
{ 
while 
( 
dr !
.! "
Read" &
(& '
)' (
)( )
{   
obj!! 
=!!  !
new!!" %
Negocio!!& -
(!!- .
)!!. /
{"" 
	IdNegocio##  )
=##* +
int##, /
.##/ 0
Parse##0 5
(##5 6
dr##6 8
[##8 9
$str##9 D
]##D E
.##E F
ToString##F N
(##N O
)##O P
)##P Q
,##Q R
Nombre$$  &
=$$' (
dr$$) +
[$$+ ,
$str$$, 4
]$$4 5
.$$5 6
ToString$$6 >
($$> ?
)$$? @
,$$@ A
RUC%%  #
=%%$ %
dr%%& (
[%%( )
$str%%) .
]%%. /
.%%/ 0
ToString%%0 8
(%%8 9
)%%9 :
,%%: ;
	Direccion&&  )
=&&* +
dr&&, .
[&&. /
$str&&/ :
]&&: ;
.&&; <
ToString&&< D
(&&D E
)&&E F
,&&F G
}'' 
;'' 
}(( 
})) 
}** 
}++ 
catch,, 
{-- 
obj.. 
=.. 
new.. 
Negocio.. !
(..! "
).." #
;..# $
}// 
return00 
obj00 
;00 
}11 	
public33 
bool33 
GuardarDatos33  
(33  !
Negocio33! (
objeto33) /
,33/ 0
out331 4
String335 ;
mensaje33< C
)33C D
{44 	
mensaje55 
=55 
String55 
.55 
Empty55 "
;55" #
bool66 
	respuesta66 
=66 
true66 !
;66! "
try88 
{99 
using:: 
(:: 
SqlConnection:: $
conexion::% -
=::. /
new::0 3
SqlConnection::4 A
(::A B
Conexion::B J
.::J K
cadena::K Q
)::Q R
)::R S
{;; 
conexion<< 
.<< 
Open<< !
(<<! "
)<<" #
;<<# $
StringBuilder>> !
query>>" '
=>>( )
new>>* -
StringBuilder>>. ;
(>>; <
)>>< =
;>>= >
query?? 
.?? 

AppendLine?? $
(??$ %
$str??% K
)??K L
;??L M
query@@ 
.@@ 

AppendLine@@ $
(@@$ %
$str@@% 2
)@@2 3
;@@3 4
queryAA 
.AA 

AppendLineAA $
(AA$ %
$strAA% =
)AA= >
;AA> ?
queryBB 
.BB 

AppendLineBB $
(BB$ %
$strBB% ;
)BB; <
;BB< =

SqlCommandDD 
cmdDD "
=DD# $
newDD% (

SqlCommandDD) 3
(DD3 4
queryDD4 9
.DD9 :
ToStringDD: B
(DDB C
)DDC D
,DDD E
conexionDDF N
)DDN O
;DDO P
cmdEE 
.EE 

ParametersEE "
.EE" #
AddWithValueEE# /
(EE/ 0
$strEE0 9
,EE9 :
objetoEE; A
.EEA B
NombreEEB H
)EEH I
;EEI J
cmdFF 
.FF 

ParametersFF "
.FF" #
AddWithValueFF# /
(FF/ 0
$strFF0 6
,FF6 7
objetoFF8 >
.FF> ?
RUCFF? B
)FFB C
;FFC D
cmdGG 
.GG 

ParametersGG "
.GG" #
AddWithValueGG# /
(GG/ 0
$strGG0 <
,GG< =
objetoGG> D
.GGD E
	DireccionGGE N
)GGN O
;GGO P
cmdHH 
.HH 
CommandTypeHH #
=HH$ %
CommandTypeHH& 1
.HH1 2
TextHH2 6
;HH6 7
ifJJ 
(JJ 
cmdJJ 
.JJ 
ExecuteNonQueryJJ *
(JJ* +
)JJ+ ,
<JJ- .
$numJJ/ 0
)JJ0 1
{KK 
mensajeLL 
=LL  !
$strLL" @
;LL@ A
	respuestaMM !
=MM" #
falseMM$ )
;MM) *
}NN 
}OO 
}PP 
catchQQ 
(QQ 
	ExceptionQQ 
exQQ 
)QQ 
{RR 
mensajeSS 
=SS 
exSS 
.SS 
MessageSS $
;SS$ %
	respuestaTT 
=TT 
falseTT !
;TT! "
}UU 
returnVV 
	respuestaVV 
;VV 
}WW 	
publicYY 
byteYY 
[YY 
]YY 
ObtenerLogoYY !
(YY! "
outYY" %
boolYY& *
obtenidoYY+ 3
)YY3 4
{ZZ 	
obtenido[[ 
=[[ 
true[[ 
;[[ 
byte\\ 
[\\ 
]\\ 
	LogoBytes\\ 
=\\ 
new\\ "
byte\\# '
[\\' (
$num\\( )
]\\) *
;\\* +
try^^ 
{__ 
using`` 
(`` 
SqlConnection`` $
conexion``% -
=``. /
new``0 3
SqlConnection``4 A
(``A B
Conexion``B J
.``J K
cadena``K Q
)``Q R
)``R S
{aa 
conexionbb 
.bb 
Openbb !
(bb! "
)bb" #
;bb# $
Stringcc 
querycc  
=cc! "
$strcc# Q
;ccQ R

SqlCommanddd 
cmddd "
=dd# $
newdd% (

SqlCommanddd) 3
(dd3 4
querydd4 9
,dd9 :
conexiondd; C
)ddC D
;ddD E
cmdee 
.ee 
CommandTypeee #
=ee$ %
CommandTypeee& 1
.ee1 2
Textee2 6
;ee6 7
usinggg 
(gg 
SqlDataReadergg (
drgg) +
=gg, -
cmdgg. 1
.gg1 2
ExecuteReadergg2 ?
(gg? @
)gg@ A
)ggA B
{hh 
whileii 
(ii 
drii !
.ii! "
Readii" &
(ii& '
)ii' (
)ii( )
{jj 
	LogoByteskk %
=kk& '
(kk( )
bytekk) -
[kk- .
]kk. /
)kk/ 0
drkk0 2
[kk2 3
$strkk3 9
]kk9 :
;kk: ;
}ll 
}mm 
}nn 
}oo 
catchpp 
{qq 
obtenidorr 
=rr 
falserr  
;rr  !
	LogoBytesss 
=ss 
newss 
bytess  $
[ss$ %
$numss% &
]ss& '
;ss' (
}tt 
returnuu 
	LogoBytesuu 
;uu 
}vv 	
publicxx 
boolxx 
ActualizarLogoxx "
(xx" #
bytexx# '
[xx' (
]xx( )
imagexx* /
,xx/ 0
outxx1 4
Stringxx5 ;
mensajexx< C
)xxC D
{yy 	
mensajezz 
=zz 
Stringzz 
.zz 
Emptyzz "
;zz" #
bool{{ 
	respuesta{{ 
={{ 
true{{ !
;{{! "
try}} 
{~~ 
using 
( 
SqlConnection $
conexion% -
=. /
new0 3
SqlConnection4 A
(A B
ConexionB J
.J K
cadenaK Q
)Q R
)R S
{
ÄÄ 
conexion
ÅÅ 
.
ÅÅ 
Open
ÅÅ !
(
ÅÅ! "
)
ÅÅ" #
;
ÅÅ# $
StringBuilder
ÉÉ !
query
ÉÉ" '
=
ÉÉ( )
new
ÉÉ* -
StringBuilder
ÉÉ. ;
(
ÉÉ; <
)
ÉÉ< =
;
ÉÉ= >
query
ÑÑ 
.
ÑÑ 

AppendLine
ÑÑ $
(
ÑÑ$ %
$str
ÑÑ% H
)
ÑÑH I
;
ÑÑI J
query
ÖÖ 
.
ÖÖ 

AppendLine
ÖÖ $
(
ÖÖ$ %
$str
ÖÖ% ;
)
ÖÖ; <
;
ÖÖ< =

SqlCommand
áá 
cmd
áá "
=
áá# $
new
áá% (

SqlCommand
áá) 3
(
áá3 4
query
áá4 9
.
áá9 :
ToString
áá: B
(
ááB C
)
ááC D
,
ááD E
conexion
ááF N
)
ááN O
;
ááO P
cmd
àà 
.
àà 

Parameters
àà "
.
àà" #
AddWithValue
àà# /
(
àà/ 0
$str
àà0 9
,
àà9 :
image
àà; @
)
àà@ A
;
ààA B
cmd
ââ 
.
ââ 
CommandType
ââ #
=
ââ$ %
CommandType
ââ& 1
.
ââ1 2
Text
ââ2 6
;
ââ6 7
if
ãã 
(
ãã 
cmd
ãã 
.
ãã 
ExecuteNonQuery
ãã +
(
ãã+ ,
)
ãã, -
<
ãã. /
$num
ãã0 1
)
ãã1 2
{
åå 
mensaje
çç 
=
çç  !
$str
çç" A
;
ççA B
	respuesta
éé !
=
éé" #
false
éé$ )
;
éé) *
}
èè 
}
êê 
}
ëë 
catch
íí 
(
íí 
	Exception
íí 
ex
íí 
)
íí  
{
ìì 
mensaje
îî 
=
îî 
ex
îî 
.
îî 
Message
îî $
;
îî$ %
	respuesta
ïï 
=
ïï 
false
ïï !
;
ïï! "
}
ññ 
return
óó 
	respuesta
óó 
;
óó 
}
òò 	
}
öö 
}õõ √T
gD:\Ingenier√≠a de Sistemas\Ingenier√≠a de Software II\SistemaDeVentaPassionDrummers\Datos\CD_Reporte.cs
	namespace

 	
Datos


 
{ 
public 

class 

CD_Reporte 
{ 
public 
List 
< 
ReporteCompra !
>! "
Compra# )
() *
String* 0
fechainicio1 <
,< =
String> D
fechafinE M
,M N
intO R
idproveedorS ^
)^ _
{ 	
List 
< 
ReporteCompra 
> 
lista  %
=& '
new( +
List, 0
<0 1
ReporteCompra1 >
>> ?
(? @
)@ A
;A B
using 
( 
SqlConnection  
	oconexion! *
=+ ,
new- 0
SqlConnection1 >
(> ?
Conexion? G
.G H
cadenaH N
)N O
)O P
{ 
try 
{ 

SqlCommand 
cmd "
=# $
new% (

SqlCommand) 3
(3 4
$str4 G
,G H
	oconexionI R
)R S
;S T
cmd 
. 

Parameters "
." #
AddWithValue# /
(/ 0
$str0 =
,= >
fechainicio? J
)J K
;K L
cmd 
. 

Parameters "
." #
AddWithValue# /
(/ 0
$str0 :
,: ;
fechafin< D
)D E
;E F
cmd 
. 

Parameters "
." #
AddWithValue# /
(/ 0
$str0 =
,= >
idproveedor? J
)J K
;K L
cmd 
. 
CommandType #
=$ %
CommandType& 1
.1 2
StoredProcedure2 A
;A B
	oconexion 
. 
Open "
(" #
)# $
;$ %
using 
( 
SqlDataReader (
dr) +
=, -
cmd. 1
.1 2
ExecuteReader2 ?
(? @
)@ A
)A B
{   
while!! 
(!! 
dr!! !
.!!! "
Read!!" &
(!!& '
)!!' (
)!!( )
{"" 
lista## !
.##! "
Add##" %
(##% &
new##& )
ReporteCompra##* 7
(##7 8
)##8 9
{$$ 
FechaRegistro%%  -
=%%. /
dr%%0 2
[%%2 3
$str%%3 B
]%%B C
.%%C D
ToString%%D L
(%%L M
)%%M N
,%%N O
TipoDocumento&&  -
=&&. /
dr&&0 2
[&&2 3
$str&&3 B
]&&B C
.&&C D
ToString&&D L
(&&L M
)&&M N
,&&N O
NumeroDocumento''  /
=''0 1
dr''2 4
[''4 5
$str''5 F
]''F G
.''G H
ToString''H P
(''P Q
)''Q R
,''R S

MontoTotal((  *
=((+ ,
dr((- /
[((/ 0
$str((0 <
]((< =
.((= >
ToString((> F
(((F G
)((G H
,((H I
UsuarioComprador))  0
=))1 2
dr))3 5
[))5 6
$str))6 H
]))H I
.))I J
ToString))J R
())R S
)))S T
,))T U
DocumentoProveedor**  2
=**3 4
dr**5 7
[**7 8
$str**8 L
]**L M
.**M N
ToString**N V
(**V W
)**W X
,**X Y
RazonSocial++  +
=++, -
dr++. 0
[++0 1
$str++1 >
]++> ?
.++? @
ToString++@ H
(++H I
)++I J
,++J K
CodigoProducto,,  .
=,,/ 0
dr,,1 3
[,,3 4
$str,,4 D
],,D E
.,,E F
ToString,,F N
(,,N O
),,O P
,,,P Q
NombreProducto--  .
=--/ 0
dr--1 3
[--3 4
$str--4 D
]--D E
.--E F
ToString--F N
(--N O
)--O P
,--P Q
	Categoria..  )
=..* +
dr.., .
[... /
$str../ :
]..: ;
...; <
ToString..< D
(..D E
)..E F
,..F G
PrecioCompra//  ,
=//- .
dr/// 1
[//1 2
$str//2 @
]//@ A
.//A B
ToString//B J
(//J K
)//K L
,//L M
PrecioVenta00  +
=00, -
dr00. 0
[000 1
$str001 >
]00> ?
.00? @
ToString00@ H
(00H I
)00I J
,00J K
Cantidad11  (
=11) *
dr11+ -
[11- .
$str11. 8
]118 9
.119 :
ToString11: B
(11B C
)11C D
,11D E
SubTotal22  (
=22) *
dr22+ -
[22- .
$str22. 8
]228 9
.229 :
ToString22: B
(22B C
)22C D
,22D E
}33 
)33 
;33 
}44 
}55 
}66 
catch77 
(77 
	Exception77  
ex77! #
)77# $
{88 
lista99 
=99 
new99 
List99  $
<99$ %
ReporteCompra99% 2
>992 3
(993 4
)994 5
;995 6
}:: 
};; 
return<< 
lista<< 
;<< 
}== 	
public?? 
List?? 
<?? 
ReporteVenta??  
>??  !
Venta??" '
(??' (
String??( .
fechainicio??/ :
,??: ;
String??< B
fechafin??C K
)??K L
{@@ 	
ListAA 
<AA 
ReporteVentaAA 
>AA 
listaAA $
=AA% &
newAA' *
ListAA+ /
<AA/ 0
ReporteVentaAA0 <
>AA< =
(AA= >
)AA> ?
;AA? @
usingCC 
(CC 
SqlConnectionCC  
	oconexionCC! *
=CC+ ,
newCC- 0
SqlConnectionCC1 >
(CC> ?
ConexionCC? G
.CCG H
cadenaCCH N
)CCN O
)CCO P
{DD 
tryEE 
{FF 

SqlCommandGG 
cmdGG "
=GG# $
newGG% (

SqlCommandGG) 3
(GG3 4
$strGG4 F
,GGF G
	oconexionGGH Q
)GGQ R
;GGR S
cmdHH 
.HH 

ParametersHH "
.HH" #
AddWithValueHH# /
(HH/ 0
$strHH0 =
,HH= >
fechainicioHH? J
)HHJ K
;HHK L
cmdII 
.II 

ParametersII "
.II" #
AddWithValueII# /
(II/ 0
$strII0 :
,II: ;
fechafinII< D
)IID E
;IIE F
cmdJJ 
.JJ 
CommandTypeJJ #
=JJ$ %
CommandTypeJJ& 1
.JJ1 2
StoredProcedureJJ2 A
;JJA B
	oconexionLL 
.LL 
OpenLL "
(LL" #
)LL# $
;LL$ %
usingNN 
(NN 
SqlDataReaderNN (
drNN) +
=NN, -
cmdNN. 1
.NN1 2
ExecuteReaderNN2 ?
(NN? @
)NN@ A
)NNA B
{OO 
whilePP 
(PP 
drPP !
.PP! "
ReadPP" &
(PP& '
)PP' (
)PP( )
{QQ 
listaRR !
.RR! "
AddRR" %
(RR% &
newRR& )
ReporteVentaRR* 6
(RR6 7
)RR7 8
{SS 
FechaRegistroTT  -
=TT. /
drTT0 2
[TT2 3
$strTT3 B
]TTB C
.TTC D
ToStringTTD L
(TTL M
)TTM N
,TTN O
TipoDocumentoUU  -
=UU. /
drUU0 2
[UU2 3
$strUU3 B
]UUB C
.UUC D
ToStringUUD L
(UUL M
)UUM N
,UUN O
NumeroDocumentoVV  /
=VV0 1
drVV2 4
[VV4 5
$strVV5 F
]VVF G
.VVG H
ToStringVVH P
(VVP Q
)VVQ R
,VVR S

MontoTotalWW  *
=WW+ ,
drWW- /
[WW/ 0
$strWW0 <
]WW< =
.WW= >
ToStringWW> F
(WWF G
)WWG H
,WWH I
UsuarioVendedorXX  /
=XX0 1
drXX2 4
[XX4 5
$strXX5 F
]XXF G
.XXG H
ToStringXXH P
(XXP Q
)XXQ R
,XXR S
DocumentoClienteYY  0
=YY1 2
drYY3 5
[YY5 6
$strYY6 H
]YYH I
.YYI J
ToStringYYJ R
(YYR S
)YYS T
,YYT U
NombreClienteZZ  -
=ZZ. /
drZZ0 2
[ZZ2 3
$strZZ3 B
]ZZB C
.ZZC D
ToStringZZD L
(ZZL M
)ZZM N
,ZZN O
CodigoProducto[[  .
=[[/ 0
dr[[1 3
[[[3 4
$str[[4 D
][[D E
.[[E F
ToString[[F N
([[N O
)[[O P
,[[P Q
NombreProducto\\  .
=\\/ 0
dr\\1 3
[\\3 4
$str\\4 D
]\\D E
.\\E F
ToString\\F N
(\\N O
)\\O P
,\\P Q
	Categoria]]  )
=]]* +
dr]], .
[]]. /
$str]]/ :
]]]: ;
.]]; <
ToString]]< D
(]]D E
)]]E F
,]]F G
PrecioVenta^^  +
=^^, -
dr^^. 0
[^^0 1
$str^^1 >
]^^> ?
.^^? @
ToString^^@ H
(^^H I
)^^I J
,^^J K
Cantidad__  (
=__) *
dr__+ -
[__- .
$str__. 8
]__8 9
.__9 :
ToString__: B
(__B C
)__C D
,__D E
SubTotal``  (
=``) *
dr``+ -
[``- .
$str``. 8
]``8 9
.``9 :
ToString``: B
(``B C
)``C D
,``D E
}aa 
)aa 
;aa 
}bb 
}cc 
}dd 
catchee 
(ee 
	Exceptionee  
exee! #
)ee# $
{ff 
listagg 
=gg 
newgg 
Listgg  $
<gg$ %
ReporteVentagg% 1
>gg1 2
(gg2 3
)gg3 4
;gg4 5
}hh 
}ii 
returnjj 
listajj 
;jj 
}kk 	
}mm 
}nn ∑∞
eD:\Ingenier√≠a de Sistemas\Ingenier√≠a de Software II\SistemaDeVentaPassionDrummers\Datos\CD_Venta.cs
	namespace

 	
Datos


 
{ 
public 

class 
CD_Venta 
{ 
public 
int 
ObtenerCorrelativo %
(% &
)& '
{ 	
int 
IdCorrelativo 
= 
$num  !
;! "
using 
( 
SqlConnection  
	oconexion! *
=+ ,
new- 0
SqlConnection1 >
(> ?
Conexion? G
.G H
cadenaH N
)N O
)O P
{ 
try 
{ 
StringBuilder !
query" '
=( )
new* -
StringBuilder. ;
(; <
)< =
;= >
query 
. 

AppendLine $
($ %
$str% E
)E F
;F G

SqlCommand 
cmd "
=# $
new% (

SqlCommand) 3
(3 4
query4 9
.9 :
ToString: B
(B C
)C D
,D E
	oconexionF O
)O P
;P Q
cmd 
. 
CommandType #
=$ %
CommandType& 1
.1 2
Text2 6
;6 7
	oconexion 
. 
Open "
(" #
)# $
;$ %
IdCorrelativo !
=" #
Convert$ +
.+ ,
ToInt32, 3
(3 4
cmd4 7
.7 8
ExecuteScalar8 E
(E F
)F G
)G H
;H I
} 
catch 
( 
	Exception  
ex! #
)# $
{   
IdCorrelativo!! !
=!!" #
$num!!$ %
;!!% &
}"" 
}## 
return%% 
IdCorrelativo%%  
;%%  !
}&& 	
public(( 
bool(( 
RestarStock(( 
(((  
int((  #

idproducto(($ .
,((. /
int((0 3
cantidad((4 <
)((< =
{)) 	
bool** 
	respuesta** 
=** 
true** !
;**! "
using,, 
(,, 
SqlConnection,,  
	oconexion,,! *
=,,+ ,
new,,- 0
SqlConnection,,1 >
(,,> ?
Conexion,,? G
.,,G H
cadena,,H N
),,N O
),,O P
{-- 
try.. 
{// 
StringBuilder00 !
query00" '
=00( )
new00* -
StringBuilder00. ;
(00; <
)00< =
;00= >
query11 
.11 

AppendLine11 $
(11$ %
$str11% s
)11s t
;11t u

SqlCommand22 
cmd22 "
=22# $
new22% (

SqlCommand22) 3
(223 4
query224 9
.229 :
ToString22: B
(22B C
)22C D
,22D E
	oconexion22F O
)22O P
;22P Q
cmd33 
.33 

Parameters33 "
.33" #
AddWithValue33# /
(33/ 0
$str330 ;
,33; <
cantidad33= E
)33E F
;33F G
cmd44 
.44 

Parameters44 "
.44" #
AddWithValue44# /
(44/ 0
$str440 =
,44= >

idproducto44? I
)44I J
;44J K
cmd55 
.55 
CommandType55 #
=55$ %
CommandType55& 1
.551 2
Text552 6
;556 7
	oconexion66 
.66 
Open66 "
(66" #
)66# $
;66$ %
	respuesta88 
=88 
cmd88  #
.88# $
ExecuteNonQuery88$ 3
(883 4
)884 5
>886 7
$num888 9
?88: ;
true88< @
:88A B
false88C H
;88H I
}:: 
catch;; 
(;; 
	Exception;;  
ex;;! #
);;# $
{<< 
	respuesta== 
=== 
false==  %
;==% &
}>> 
}?? 
returnAA 
	respuestaAA 
;AA 
}BB 	
publicDD 
boolDD 

SumarStockDD 
(DD 
intDD "

idproductoDD# -
,DD- .
intDD/ 2
cantidadDD3 ;
)DD; <
{EE 	
boolFF 
	respuestaFF 
=FF 
trueFF !
;FF! "
usingHH 
(HH 
SqlConnectionHH  
	oconexionHH! *
=HH+ ,
newHH- 0
SqlConnectionHH1 >
(HH> ?
ConexionHH? G
.HHG H
cadenaHHH N
)HHN O
)HHO P
{II 
tryJJ 
{KK 
StringBuilderLL !
queryLL" '
=LL( )
newLL* -
StringBuilderLL. ;
(LL; <
)LL< =
;LL= >
queryMM 
.MM 

AppendLineMM $
(MM$ %
$strMM% s
)MMs t
;MMt u

SqlCommandNN 
cmdNN "
=NN# $
newNN% (

SqlCommandNN) 3
(NN3 4
queryNN4 9
.NN9 :
ToStringNN: B
(NNB C
)NNC D
,NND E
	oconexionNNF O
)NNO P
;NNP Q
cmdOO 
.OO 

ParametersOO "
.OO" #
AddWithValueOO# /
(OO/ 0
$strOO0 ;
,OO; <
cantidadOO= E
)OOE F
;OOF G
cmdPP 
.PP 

ParametersPP "
.PP" #
AddWithValuePP# /
(PP/ 0
$strPP0 =
,PP= >

idproductoPP? I
)PPI J
;PPJ K
cmdQQ 
.QQ 
CommandTypeQQ #
=QQ$ %
CommandTypeQQ& 1
.QQ1 2
TextQQ2 6
;QQ6 7
	oconexionRR 
.RR 
OpenRR "
(RR" #
)RR# $
;RR$ %
	respuestaTT 
=TT 
cmdTT  #
.TT# $
ExecuteNonQueryTT$ 3
(TT3 4
)TT4 5
>TT6 7
$numTT8 9
?TT: ;
trueTT< @
:TTA B
falseTTC H
;TTH I
}VV 
catchWW 
(WW 
	ExceptionWW  
exWW! #
)WW# $
{XX 
	respuestaYY 
=YY 
falseYY  %
;YY% &
}ZZ 
}[[ 
return]] 
	respuesta]] 
;]] 
}^^ 	
public`` 
bool`` 
	Registrar`` 
(`` 
Venta`` #
obj``$ '
,``' (
	DataTable``) 2
DetalleVenta``3 ?
,``? @
out``A D
String``E K
Mensaje``L S
)``S T
{aa 	
boolbb 
	Respuestabb 
=bb 
falsebb "
;bb" #
Mensajecc 
=cc 
Stringcc 
.cc 
Emptycc "
;cc" #
usingee 
(ee 
SqlConnectionee  
	oconexionee! *
=ee+ ,
newee- 0
SqlConnectionee1 >
(ee> ?
Conexionee? G
.eeG H
cadenaeeH N
)eeN O
)eeO P
{ff 
trygg 
{hh 

SqlCommandii 
cmdii "
=ii# $
newii% (

SqlCommandii) 3
(ii3 4
$strii4 G
,iiG H
	oconexioniiI R
)iiR S
;iiS T
cmdjj 
.jj 

Parametersjj "
.jj" #
AddWithValuejj# /
(jj/ 0
$strjj0 ;
,jj; <
objjj= @
.jj@ A
oUsuariojjA I
.jjI J
IdjjJ L
)jjL M
;jjM N
cmdkk 
.kk 

Parameterskk "
.kk" #
AddWithValuekk# /
(kk/ 0
$strkk0 ?
,kk? @
objkkA D
.kkD E
TipoDocumentokkE R
)kkR S
;kkS T
cmdll 
.ll 

Parametersll "
.ll" #
AddWithValuell# /
(ll/ 0
$strll0 A
,llA B
objllC F
.llF G
NumeroDocumentollG V
)llV W
;llW X
cmdmm 
.mm 

Parametersmm "
.mm" #
AddWithValuemm# /
(mm/ 0
$strmm0 B
,mmB C
objmmD G
.mmG H
DocumentoCLientemmH X
)mmX Y
;mmY Z
cmdnn 
.nn 

Parametersnn "
.nn" #
AddWithValuenn# /
(nn/ 0
$strnn0 ?
,nn? @
objnnA D
.nnD E
NombreClientennE R
)nnR S
;nnS T
cmdoo 
.oo 

Parametersoo "
.oo" #
AddWithValueoo# /
(oo/ 0
$stroo0 ;
,oo; <
objoo= @
.oo@ A
	MontoPagoooA J
)ooJ K
;ooK L
cmdpp 
.pp 

Parameterspp "
.pp" #
AddWithValuepp# /
(pp/ 0
$strpp0 =
,pp= >
objpp? B
.ppB C
MontoCambioppC N
)ppN O
;ppO P
cmdqq 
.qq 

Parametersqq "
.qq" #
AddWithValueqq# /
(qq/ 0
$strqq0 <
,qq< =
objqq> A
.qqA B

MontoTotalqqB L
)qqL M
;qqM N
cmdrr 
.rr 

Parametersrr "
.rr" #
AddWithValuerr# /
(rr/ 0
$strrr0 >
,rr> ?
DetalleVentarr@ L
)rrL M
;rrM N
cmdss 
.ss 

Parametersss "
.ss" #
Addss# &
(ss& '
$strss' 2
,ss2 3
	SqlDbTypess4 =
.ss= >
Bitss> A
)ssA B
.ssB C
	DirectionssC L
=ssM N
ParameterDirectionssO a
.ssa b
Outputssb h
;ssh i
cmdtt 
.tt 

Parameterstt "
.tt" #
Addtt# &
(tt& '
$strtt' 0
,tt0 1
	SqlDbTypett2 ;
.tt; <
VarChartt< C
,ttC D
$numttE H
)ttH I
.ttI J
	DirectionttJ S
=ttT U
ParameterDirectionttV h
.tth i
Outputtti o
;tto p
cmduu 
.uu 
CommandTypeuu #
=uu$ %
CommandTypeuu& 1
.uu1 2
StoredProcedureuu2 A
;uuA B
	oconexionww 
.ww 
Openww "
(ww" #
)ww# $
;ww$ %
cmdxx 
.xx 
ExecuteNonQueryxx '
(xx' (
)xx( )
;xx) *
	Respuestazz 
=zz 
Convertzz  '
.zz' (
	ToBooleanzz( 1
(zz1 2
cmdzz2 5
.zz5 6

Parameterszz6 @
[zz@ A
$strzzA L
]zzL M
.zzM N
ValuezzN S
)zzS T
;zzT U
Mensaje{{ 
={{ 
cmd{{ !
.{{! "

Parameters{{" ,
[{{, -
$str{{- 6
]{{6 7
.{{7 8
Value{{8 =
.{{= >
ToString{{> F
({{F G
){{G H
;{{H I
}}} 
catch~~ 
(~~ 
	Exception~~  
ex~~! #
)~~# $
{ 
	Respuesta
ÄÄ 
=
ÄÄ 
false
ÄÄ  %
;
ÄÄ% &
Mensaje
ÅÅ 
=
ÅÅ 
ex
ÅÅ  
.
ÅÅ  !
Message
ÅÅ! (
;
ÅÅ( )
}
ÇÇ 
}
ÉÉ 
return
ÑÑ 
	Respuesta
ÑÑ 
;
ÑÑ 
}
ÖÖ 	
public
áá 
Venta
áá 
ObtenerVenta
áá !
(
áá! "
String
áá" (
numero
áá) /
)
áá/ 0
{
àà 	
Venta
ââ 
obj
ââ 
=
ââ 
new
ââ 
Venta
ââ !
(
ââ! "
)
ââ" #
;
ââ# $
using
ãã 
(
ãã 
SqlConnection
ãã  
	oconexion
ãã! *
=
ãã+ ,
new
ãã- 0
SqlConnection
ãã1 >
(
ãã> ?
Conexion
ãã? G
.
ããG H
cadena
ããH N
)
ããN O
)
ããO P
{
åå 
try
çç 
{
éé 
	oconexion
èè 
.
èè 
Open
èè "
(
èè" #
)
èè# $
;
èè$ %
StringBuilder
êê !
query
êê" '
=
êê( )
new
êê* -
StringBuilder
êê. ;
(
êê; <
)
êê< =
;
êê= >
query
ëë 
.
ëë 

AppendLine
ëë $
(
ëë$ %
$str
ëë% J
)
ëëJ K
;
ëëK L
query
íí 
.
íí 

AppendLine
íí $
(
íí$ %
$str
íí% K
)
ííK L
;
ííL M
query
ìì 
.
ìì 

AppendLine
ìì $
(
ìì$ %
$str
ìì% J
)
ììJ K
;
ììK L
query
îî 
.
îî 

AppendLine
îî $
(
îî$ %
$str
îî% P
)
îîP Q
;
îîQ R
query
ïï 
.
ïï 

AppendLine
ïï $
(
ïï$ %
$str
ïï% [
)
ïï[ \
;
ïï\ ]
query
ññ 
.
ññ 

AppendLine
ññ $
(
ññ$ %
$str
ññ% 3
)
ññ3 4
;
ññ4 5
query
óó 
.
óó 

AppendLine
óó $
(
óó$ %
$str
óó% X
)
óóX Y
;
óóY Z
query
òò 
.
òò 

AppendLine
òò $
(
òò$ %
$str
òò% H
)
òòH I
;
òòI J

SqlCommand
öö 
cmd
öö "
=
öö# $
new
öö% (

SqlCommand
öö) 3
(
öö3 4
query
öö4 9
.
öö9 :
ToString
öö: B
(
ööB C
)
ööC D
,
ööD E
	oconexion
ööF O
)
ööO P
;
ööP Q
cmd
õõ 
.
õõ 

Parameters
õõ "
.
õõ" #
AddWithValue
õõ# /
(
õõ/ 0
$str
õõ0 9
,
õõ9 :
numero
õõ; A
)
õõA B
;
õõB C
cmd
úú 
.
úú 
CommandType
úú #
=
úú$ %
CommandType
úú& 1
.
úú1 2
Text
úú2 6
;
úú6 7
using
ûû 
(
ûû 
SqlDataReader
ûû (
dr
ûû) +
=
ûû, -
cmd
ûû. 1
.
ûû1 2
ExecuteReader
ûû2 ?
(
ûû? @
)
ûû@ A
)
ûûA B
{
üü 
while
†† 
(
†† 
dr
†† !
.
††! "
Read
††" &
(
††& '
)
††' (
)
††( )
{
°° 
obj
¢¢ 
=
¢¢  !
new
¢¢" %
Venta
¢¢& +
(
¢¢+ ,
)
¢¢, -
{
££ 
IdVenta
§§  '
=
§§( )
Convert
§§* 1
.
§§1 2
ToInt32
§§2 9
(
§§9 :
dr
§§: <
[
§§< =
$str
§§= F
]
§§F G
)
§§G H
,
§§H I
oUsuario
••  (
=
••) *
new
••+ .
Usuario
••/ 6
(
••6 7
)
••7 8
{
••9 :
NombreCompleto
••; I
=
••J K
dr
••L N
[
••N O
$str
••O _
]
••_ `
.
••` a
ToString
••a i
(
••i j
)
••j k
}
••l m
,
••m n
DocumentoCLiente
¶¶  0
=
¶¶1 2
dr
¶¶3 5
[
¶¶5 6
$str
¶¶6 H
]
¶¶H I
.
¶¶I J
ToString
¶¶J R
(
¶¶R S
)
¶¶S T
,
¶¶T U
NombreCliente
ßß  -
=
ßß. /
dr
ßß0 2
[
ßß2 3
$str
ßß3 B
]
ßßB C
.
ßßC D
ToString
ßßD L
(
ßßL M
)
ßßM N
,
ßßN O
TipoDocumento
®®  -
=
®®. /
dr
®®0 2
[
®®2 3
$str
®®3 B
]
®®B C
.
®®C D
ToString
®®D L
(
®®L M
)
®®M N
,
®®N O
NumeroDocumento
©©  /
=
©©0 1
dr
©©2 4
[
©©4 5
$str
©©5 F
]
©©F G
.
©©G H
ToString
©©H P
(
©©P Q
)
©©Q R
,
©©R S
	MontoPago
™™  )
=
™™* +
Convert
™™, 3
.
™™3 4
	ToDecimal
™™4 =
(
™™= >
dr
™™> @
[
™™@ A
$str
™™A L
]
™™L M
.
™™M N
ToString
™™N V
(
™™V W
)
™™W X
)
™™X Y
,
™™Y Z
MontoCambio
´´  +
=
´´, -
Convert
´´. 5
.
´´5 6
	ToDecimal
´´6 ?
(
´´? @
dr
´´@ B
[
´´B C
$str
´´C P
]
´´P Q
.
´´Q R
ToString
´´R Z
(
´´Z [
)
´´[ \
)
´´\ ]
,
´´] ^

MontoTotal
¨¨  *
=
¨¨+ ,
Convert
¨¨- 4
.
¨¨4 5
	ToDecimal
¨¨5 >
(
¨¨> ?
dr
¨¨? A
[
¨¨A B
$str
¨¨B N
]
¨¨N O
.
¨¨O P
ToString
¨¨P X
(
¨¨X Y
)
¨¨Y Z
)
¨¨Z [
,
¨¨[ \
FechaRegistro
≠≠  -
=
≠≠. /
dr
≠≠0 2
[
≠≠2 3
$str
≠≠3 B
]
≠≠B C
.
≠≠C D
ToString
≠≠D L
(
≠≠L M
)
≠≠M N
}
ÆÆ 
;
ÆÆ 
}
ØØ 
}
∞∞ 
}
≤≤ 
catch
≥≥ 
(
≥≥ 
	Exception
≥≥  
ex
≥≥! #
)
≥≥# $
{
¥¥ 
obj
µµ 
=
µµ 
new
µµ 
Venta
µµ #
(
µµ# $
)
µµ$ %
;
µµ% &
}
∂∂ 
}
∑∑ 
return
∏∏ 
obj
∏∏ 
;
∏∏ 
}
ππ 	
public
ªª 
List
ªª 
<
ªª 
Detalle_Venta
ªª !
>
ªª! "!
ObtenerDetalleVenta
ªª# 6
(
ªª6 7
int
ªª7 :
idventa
ªª; B
)
ªªB C
{
ºº 	
List
ΩΩ 
<
ΩΩ 
Detalle_Venta
ΩΩ 
>
ΩΩ 
oLista
ΩΩ  &
=
ΩΩ' (
new
ΩΩ) ,
List
ΩΩ- 1
<
ΩΩ1 2
Detalle_Venta
ΩΩ2 ?
>
ΩΩ? @
(
ΩΩ@ A
)
ΩΩA B
;
ΩΩB C
try
ææ 
{
øø 
using
¿¿ 
(
¿¿ 
SqlConnection
¿¿ $
	oconexion
¿¿% .
=
¿¿/ 0
new
¿¿1 4
SqlConnection
¿¿5 B
(
¿¿B C
Conexion
¿¿C K
.
¿¿K L
cadena
¿¿L R
)
¿¿R S
)
¿¿S T
{
¡¡ 
	oconexion
¬¬ 
.
¬¬ 
Open
¬¬ "
(
¬¬" #
)
¬¬# $
;
¬¬$ %
StringBuilder
√√ !
query
√√" '
=
√√( )
new
√√* -
StringBuilder
√√. ;
(
√√; <
)
√√< =
;
√√= >
query
≈≈ 
.
≈≈ 

AppendLine
≈≈ $
(
≈≈$ %
$str
≈≈% v
)
≈≈v w
;
≈≈w x
query
∆∆ 
.
∆∆ 

AppendLine
∆∆ $
(
∆∆$ %
$str
∆∆% \
)
∆∆\ ]
;
∆∆] ^
query
«« 
.
«« 

AppendLine
«« $
(
««$ %
$str
««% B
)
««B C
;
««C D

SqlCommand
…… 
cmd
…… "
=
……# $
new
……% (

SqlCommand
……) 3
(
……3 4
query
……4 9
.
……9 :
ToString
……: B
(
……B C
)
……C D
,
……D E
	oconexion
……F O
)
……O P
;
……P Q
cmd
   
.
   

Parameters
   "
.
  " #
AddWithValue
  # /
(
  / 0
$str
  0 :
,
  : ;
idventa
  < C
)
  C D
;
  D E
cmd
ÀÀ 
.
ÀÀ 
CommandType
ÀÀ #
=
ÀÀ$ %
System
ÀÀ& ,
.
ÀÀ, -
Data
ÀÀ- 1
.
ÀÀ1 2
CommandType
ÀÀ2 =
.
ÀÀ= >
Text
ÀÀ> B
;
ÀÀB C
using
ÕÕ 
(
ÕÕ 
SqlDataReader
ÕÕ (
dr
ÕÕ) +
=
ÕÕ, -
cmd
ÕÕ. 1
.
ÕÕ1 2
ExecuteReader
ÕÕ2 ?
(
ÕÕ? @
)
ÕÕ@ A
)
ÕÕA B
{
ŒŒ 
while
œœ 
(
œœ 
dr
œœ !
.
œœ! "
Read
œœ" &
(
œœ& '
)
œœ' (
)
œœ( )
{
–– 
oLista
—— "
.
——" #
Add
——# &
(
——& '
new
——' *
Detalle_Venta
——+ 8
(
——8 9
)
——9 :
{
““ 
	oProducto
””  )
=
””* +
new
””, /
Producto
””0 8
(
””8 9
)
””9 :
{
””; <
Nombre
””= C
=
””D E
dr
””F H
[
””H I
$str
””I Q
]
””Q R
.
””R S
ToString
””S [
(
””[ \
)
””\ ]
}
””^ _
,
””_ `
PrecioVenta
‘‘  +
=
‘‘, -
Convert
‘‘. 5
.
‘‘5 6
	ToDecimal
‘‘6 ?
(
‘‘? @
dr
‘‘@ B
[
‘‘B C
$str
‘‘C P
]
‘‘P Q
.
‘‘Q R
ToString
‘‘R Z
(
‘‘Z [
)
‘‘[ \
)
‘‘\ ]
,
‘‘] ^
Cantidad
’’  (
=
’’) *
Convert
’’+ 2
.
’’2 3
ToInt32
’’3 :
(
’’: ;
dr
’’; =
[
’’= >
$str
’’> H
]
’’H I
.
’’I J
ToString
’’J R
(
’’R S
)
’’S T
)
’’T U
,
’’U V
SubTotal
÷÷  (
=
÷÷) *
Convert
÷÷+ 2
.
÷÷2 3
	ToDecimal
÷÷3 <
(
÷÷< =
dr
÷÷= ?
[
÷÷? @
$str
÷÷@ J
]
÷÷J K
.
÷÷K L
ToString
÷÷L T
(
÷÷T U
)
÷÷U V
)
÷÷V W
,
÷÷W X
}
◊◊ 
)
◊◊ 
;
◊◊ 
}
ÿÿ 
}
ŸŸ 
}
⁄⁄ 
}
€€ 
catch
‹‹ 
(
‹‹ 
	Exception
‹‹ 
ex
‹‹ 
)
‹‹  
{
›› 
oLista
ﬁﬁ 
=
ﬁﬁ 
new
ﬁﬁ 
List
ﬁﬁ !
<
ﬁﬁ! "
Detalle_Venta
ﬁﬁ" /
>
ﬁﬁ/ 0
(
ﬁﬁ0 1
)
ﬁﬁ1 2
;
ﬁﬁ2 3
}
ﬂﬂ 
return
‡‡ 
oLista
‡‡ 
;
‡‡ 
}
·· 	
}
„„ 
}‰‰ µ
eD:\Ingenier√≠a de Sistemas\Ingenier√≠a de Software II\SistemaDeVentaPassionDrummers\Datos\Conexion.cs
	namespace 	
Datos
 
{		 
public

 

class

 
Conexion

 
{ 
public 
static 
String 
cadena #
=$ % 
ConfigurationManager& :
.: ;
ConnectionStrings; L
[L M
$strM ^
]^ _
._ `
ToString` h
(h i
)i j
;j k
} 
} ˘
kD:\Ingenier√≠a de Sistemas\Ingenier√≠a de Software II\SistemaDeVentaPassionDrummers\Datos\ICrudBaseDatos.cs
	namespace 	
Datos
 
{ 
public 

	interface 
ICrudBaseDatos #
<# $
T$ %
>% &
{		 
List

 
<

 
T

 
>

 
Listar

 
(

 
)

 
;

 
int 
	Registrar 
( 
T 
obj 
, 
out  
String! '
Mensaje( /
)/ 0
;0 1
bool 
Editar 
( 
T 
obj 
, 
out 
String %
Mensaje& -
)- .
;. /
bool 
Eliminar 
( 
T 
obj 
, 
out  
String! '
Mensaje( /
)/ 0
;0 1
} 
} ü
tD:\Ingenier√≠a de Sistemas\Ingenier√≠a de Software II\SistemaDeVentaPassionDrummers\Datos\Properties\AssemblyInfo.cs
[ 
assembly 	
:	 

AssemblyTitle 
( 
$str  
)  !
]! "
[		 
assembly		 	
:			 

AssemblyDescription		 
(		 
$str		 !
)		! "
]		" #
[

 
assembly

 	
:

	 
!
AssemblyConfiguration

  
(

  !
$str

! #
)

# $
]

$ %
[ 
assembly 	
:	 

AssemblyCompany 
( 
$str 
) 
] 
[ 
assembly 	
:	 

AssemblyProduct 
( 
$str "
)" #
]# $
[ 
assembly 	
:	 

AssemblyCopyright 
( 
$str 0
)0 1
]1 2
[ 
assembly 	
:	 

AssemblyTrademark 
( 
$str 
)  
]  !
[ 
assembly 	
:	 

AssemblyCulture 
( 
$str 
) 
] 
[ 
assembly 	
:	 


ComVisible 
( 
false 
) 
] 
[ 
assembly 	
:	 

Guid 
( 
$str 6
)6 7
]7 8
[## 
assembly## 	
:##	 

AssemblyVersion## 
(## 
$str## $
)##$ %
]##% &
[$$ 
assembly$$ 	
:$$	 

AssemblyFileVersion$$ 
($$ 
$str$$ (
)$$( )
]$$) *πk
qD:\Ingenier√≠a de Sistemas\Ingenier√≠a de Software II\SistemaDeVentaPassionDrummers\Datos\RepositorioCategoria.cs
	namespace		 	
Datos		
 
{

 
public 

class  
RepositorioCategoria %
:& '
ICrudBaseDatos( 6
<6 7
	Categoria7 @
>@ A
{ 
public 
bool 
Editar 
( 
	Categoria $
obj% (
,( )
out* -
string. 4
Mensaje5 <
)< =
{ 	
bool 
	Respuesta 
= 
false "
;" #
Mensaje 
= 
String 
. 
Empty "
;" #
try 
{ 
using 
( 
SqlConnection $
	oconexion% .
=/ 0
new1 4
SqlConnection5 B
(B C
ConexionC K
.K L
cadenaL R
)R S
)S T
{ 

SqlCommand 
cmd "
=# $
new% (

SqlCommand) 3
(3 4
$str4 H
,H I
	oconexionJ S
)S T
;T U
cmd 
. 

Parameters "
." #
AddWithValue# /
(/ 0
$str0 =
,= >
obj? B
.B C
IdCategoriaC N
)N O
;O P
cmd 
. 

Parameters "
." #
AddWithValue# /
(/ 0
$str0 =
,= >
obj? B
.B C
DescripcionC N
)N O
;O P
cmd 
. 

Parameters "
." #
AddWithValue# /
(/ 0
$str0 8
,8 9
obj: =
.= >
Estado> D
)D E
;E F
cmd 
. 

Parameters "
." #
Add# &
(& '
$str' 2
,2 3
	SqlDbType4 =
.= >
Int> A
)A B
.B C
	DirectionC L
=M N
ParameterDirectionO a
.a b
Outputb h
;h i
cmd 
. 

Parameters "
." #
Add# &
(& '
$str' 0
,0 1
	SqlDbType2 ;
.; <
VarChar< C
,C D
$numE H
)H I
.I J
	DirectionJ S
=T U
ParameterDirectionV h
.h i
Outputi o
;o p
cmd 
. 
CommandType #
=$ %
CommandType& 1
.1 2
StoredProcedure2 A
;A B
	oconexion 
. 
Open "
(" #
)# $
;$ %
cmd 
. 
ExecuteNonQuery '
(' (
)( )
;) *
	Respuesta!! 
=!! 
Convert!!  '
.!!' (
	ToBoolean!!( 1
(!!1 2
cmd!!2 5
.!!5 6

Parameters!!6 @
[!!@ A
$str!!A L
]!!L M
.!!M N
Value!!N S
)!!S T
;!!T U
Mensaje"" 
="" 
cmd"" !
.""! "

Parameters""" ,
["", -
$str""- 6
]""6 7
.""7 8
Value""8 =
.""= >
ToString""> F
(""F G
)""G H
;""H I
}## 
}$$ 
catch%% 
(%% 
	Exception%% 
ex%% 
)%%  
{&& 
	Respuesta'' 
='' 
false'' !
;''! "
Mensaje(( 
=(( 
ex(( 
.(( 
Message(( $
;(($ %
})) 
return++ 
	Respuesta++ 
;++ 
},, 	
public.. 
bool.. 
Eliminar.. 
(.. 
	Categoria.. &
obj..' *
,..* +
out.., /
string..0 6
Mensaje..7 >
)..> ?
{// 	
bool00 
	Respuesta00 
=00 
false00 "
;00" #
Mensaje11 
=11 
String11 
.11 
Empty11 "
;11" #
try33 
{44 
using55 
(55 
SqlConnection55 $
	oconexion55% .
=55/ 0
new551 4
SqlConnection555 B
(55B C
Conexion55C K
.55K L
cadena55L R
)55R S
)55S T
{66 

SqlCommand77 
cmd77 "
=77# $
new77% (

SqlCommand77) 3
(773 4
$str774 J
,77J K
	oconexion77L U
)77U V
;77V W
cmd88 
.88 

Parameters88 "
.88" #
AddWithValue88# /
(88/ 0
$str880 =
,88= >
obj88? B
.88B C
IdCategoria88C N
)88N O
;88O P
cmd99 
.99 

Parameters99 "
.99" #
Add99# &
(99& '
$str99' 2
,992 3
	SqlDbType994 =
.99= >
Int99> A
)99A B
.99B C
	Direction99C L
=99M N
ParameterDirection99O a
.99a b
Output99b h
;99h i
cmd:: 
.:: 

Parameters:: "
.::" #
Add::# &
(::& '
$str::' 0
,::0 1
	SqlDbType::2 ;
.::; <
VarChar::< C
,::C D
$num::E H
)::H I
.::I J
	Direction::J S
=::T U
ParameterDirection::V h
.::h i
Output::i o
;::o p
cmd;; 
.;; 
CommandType;; #
=;;$ %
CommandType;;& 1
.;;1 2
StoredProcedure;;2 A
;;;A B
	oconexion<< 
.<< 
Open<< "
(<<" #
)<<# $
;<<$ %
cmd>> 
.>> 
ExecuteNonQuery>> '
(>>' (
)>>( )
;>>) *
	Respuesta@@ 
=@@ 
Convert@@  '
.@@' (
	ToBoolean@@( 1
(@@1 2
cmd@@2 5
.@@5 6

Parameters@@6 @
[@@@ A
$str@@A L
]@@L M
.@@M N
Value@@N S
)@@S T
;@@T U
MensajeAA 
=AA 
cmdAA !
.AA! "

ParametersAA" ,
[AA, -
$strAA- 6
]AA6 7
.AA7 8
ValueAA8 =
.AA= >
ToStringAA> F
(AAF G
)AAG H
;AAH I
}BB 
}CC 
catchDD 
(DD 
	ExceptionDD 
exDD 
)DD  
{EE 
	RespuestaFF 
=FF 
falseFF !
;FF! "
MensajeGG 
=GG 
exGG 
.GG 
MessageGG $
;GG$ %
}HH 
returnJJ 
	RespuestaJJ 
;JJ 
}KK 	
publicMM 
ListMM 
<MM 
	CategoriaMM 
>MM 
ListarMM %
(MM% &
)MM& '
{NN 	
ListOO 
<OO 
	CategoriaOO 
>OO 
listaOO !
=OO" #
newOO$ '
ListOO( ,
<OO, -
	CategoriaOO- 6
>OO6 7
(OO7 8
)OO8 9
;OO9 :
usingQQ 
(QQ 
SqlConnectionQQ  
	oconexionQQ! *
=QQ+ ,
newQQ- 0
SqlConnectionQQ1 >
(QQ> ?
ConexionQQ? G
.QQG H
cadenaQQH N
)QQN O
)QQO P
{RR 
trySS 
{TT 
StringBuilderUU !
queryUU" '
=UU( )
newUU* -
StringBuilderUU. ;
(UU; <
)UU< =
;UU= >
queryVV 
.VV 

AppendLineVV $
(VV$ %
$strVV% [
)VV[ \
;VV\ ]

SqlCommandWW 
cmdWW "
=WW# $
newWW% (

SqlCommandWW) 3
(WW3 4
queryWW4 9
.WW9 :
ToStringWW: B
(WWB C
)WWC D
,WWD E
	oconexionWWF O
)WWO P
;WWP Q
cmdXX 
.XX 
CommandTypeXX #
=XX$ %
CommandTypeXX& 1
.XX1 2
TextXX2 6
;XX6 7
	oconexionZZ 
.ZZ 
OpenZZ "
(ZZ" #
)ZZ# $
;ZZ$ %
using\\ 
(\\ 
SqlDataReader\\ (
dr\\) +
=\\, -
cmd\\. 1
.\\1 2
ExecuteReader\\2 ?
(\\? @
)\\@ A
)\\A B
{]] 
while^^ 
(^^ 
dr^^ !
.^^! "
Read^^" &
(^^& '
)^^' (
)^^( )
{__ 
lista`` !
.``! "
Add``" %
(``% &
new``& )
	Categoria``* 3
(``3 4
)``4 5
{aa 
IdCategoriabb  +
=bb, -
Convertbb. 5
.bb5 6
ToInt32bb6 =
(bb= >
drbb> @
[bb@ A
$strbbA N
]bbN O
)bbO P
,bbP Q
Descripcioncc  +
=cc, -
drcc. 0
[cc0 1
$strcc1 >
]cc> ?
.cc? @
ToStringcc@ H
(ccH I
)ccI J
,ccJ K
Estadodd  &
=dd' (
Convertdd) 0
.dd0 1
	ToBooleandd1 :
(dd: ;
drdd; =
[dd= >
$strdd> F
]ddF G
)ddG H
}ee 
)ee 
;ee 
}ff 
}gg 
}ii 
catchjj 
(jj 
	Exceptionjj  
exjj! #
)jj# $
{kk 
listamm 
=mm 
newmm 
Listmm  $
<mm$ %
	Categoriamm% .
>mm. /
(mm/ 0
)mm0 1
;mm1 2
}nn 
}oo 
returnpp 
listapp 
;pp 
}qq 	
publicss 
intss 
	Registrarss 
(ss 
	Categoriass &
objss' *
,ss* +
outss, /
stringss0 6
Mensajess7 >
)ss> ?
{tt 	
intuu 
idCategoriageneradouu #
=uu$ %
$numuu& '
;uu' (
Mensajevv 
=vv 
Stringvv 
.vv 
Emptyvv "
;vv" #
tryxx 
{yy 
usingzz 
(zz 
SqlConnectionzz $
	oconexionzz% .
=zz/ 0
newzz1 4
SqlConnectionzz5 B
(zzB C
ConexionzzC K
.zzK L
cadenazzL R
)zzR S
)zzS T
{{{ 

SqlCommand|| 
cmd|| "
=||# $
new||% (

SqlCommand||) 3
(||3 4
$str||4 K
,||K L
	oconexion||M V
)||V W
;||W X
cmd}} 
.}} 

Parameters}} "
.}}" #
AddWithValue}}# /
(}}/ 0
$str}}0 =
,}}= >
obj}}? B
.}}B C
Descripcion}}C N
)}}N O
;}}O P
cmd~~ 
.~~ 

Parameters~~ "
.~~" #
AddWithValue~~# /
(~~/ 0
$str~~0 8
,~~8 9
obj~~: =
.~~= >
Estado~~> D
)~~D E
;~~E F
cmd 
. 

Parameters "
." #
Add# &
(& '
$str' 2
,2 3
	SqlDbType4 =
.= >
Int> A
)A B
.B C
	DirectionC L
=M N
ParameterDirectionO a
.a b
Outputb h
;h i
cmd
ÄÄ 
.
ÄÄ 

Parameters
ÄÄ "
.
ÄÄ" #
Add
ÄÄ# &
(
ÄÄ& '
$str
ÄÄ' 0
,
ÄÄ0 1
	SqlDbType
ÄÄ2 ;
.
ÄÄ; <
VarChar
ÄÄ< C
,
ÄÄC D
$num
ÄÄE H
)
ÄÄH I
.
ÄÄI J
	Direction
ÄÄJ S
=
ÄÄT U 
ParameterDirection
ÄÄV h
.
ÄÄh i
Output
ÄÄi o
;
ÄÄo p
cmd
ÅÅ 
.
ÅÅ 
CommandType
ÅÅ #
=
ÅÅ$ %
CommandType
ÅÅ& 1
.
ÅÅ1 2
StoredProcedure
ÅÅ2 A
;
ÅÅA B
	oconexion
ÇÇ 
.
ÇÇ 
Open
ÇÇ "
(
ÇÇ" #
)
ÇÇ# $
;
ÇÇ$ %
cmd
ÑÑ 
.
ÑÑ 
ExecuteNonQuery
ÑÑ '
(
ÑÑ' (
)
ÑÑ( )
;
ÑÑ) *!
idCategoriagenerado
ÜÜ '
=
ÜÜ( )
Convert
ÜÜ* 1
.
ÜÜ1 2
ToInt32
ÜÜ2 9
(
ÜÜ9 :
cmd
ÜÜ: =
.
ÜÜ= >

Parameters
ÜÜ> H
[
ÜÜH I
$str
ÜÜI T
]
ÜÜT U
.
ÜÜU V
Value
ÜÜV [
)
ÜÜ[ \
;
ÜÜ\ ]
Mensaje
áá 
=
áá 
cmd
áá !
.
áá! "

Parameters
áá" ,
[
áá, -
$str
áá- 6
]
áá6 7
.
áá7 8
Value
áá8 =
.
áá= >
ToString
áá> F
(
ááF G
)
ááG H
;
ááH I
}
àà 
}
ââ 
catch
ää 
(
ää 
	Exception
ää 
ex
ää 
)
ää  
{
ãã !
idCategoriagenerado
åå #
=
åå$ %
$num
åå& '
;
åå' (
Mensaje
çç 
=
çç 
ex
çç 
.
çç 
Message
çç $
;
çç$ %
}
éé 
return
êê !
idCategoriagenerado
êê &
;
êê& '
}
ëë 	
}
íí 
}ìì är
oD:\Ingenier√≠a de Sistemas\Ingenier√≠a de Software II\SistemaDeVentaPassionDrummers\Datos\RepositorioCliente.cs
	namespace		 	
Datos		
 
{

 
public 

class 
RepositorioCliente #
:$ %
ICrudBaseDatos& 4
<4 5
Cliente5 <
>< =
{ 
public 
bool 
Editar 
( 
Cliente "
obj# &
,& '
out( +
string, 2
Mensaje3 :
): ;
{ 	
bool 
	Respuesta 
= 
false "
;" #
Mensaje 
= 
String 
. 
Empty "
;" #
try 
{ 
using 
( 
SqlConnection $
	oconexion% .
=/ 0
new1 4
SqlConnection5 B
(B C
ConexionC K
.K L
cadenaL R
)R S
)S T
{ 

SqlCommand 
cmd "
=# $
new% (

SqlCommand) 3
(3 4
$str4 I
,I J
	oconexionK T
)T U
;U V
cmd 
. 

Parameters "
." #
AddWithValue# /
(/ 0
$str0 ;
,; <
obj= @
.@ A
IdA C
)C D
;D E
cmd 
. 

Parameters "
." #
AddWithValue# /
(/ 0
$str0 ;
,; <
obj= @
.@ A
	DocumentoA J
)J K
;K L
cmd 
. 

Parameters "
." #
AddWithValue# /
(/ 0
$str0 @
,@ A
objB E
.E F
NombreCompletoF T
)T U
;U V
cmd 
. 

Parameters "
." #
AddWithValue# /
(/ 0
$str0 8
,8 9
obj: =
.= >
Correo> D
)D E
;E F
cmd 
. 

Parameters "
." #
AddWithValue# /
(/ 0
$str0 :
,: ;
obj< ?
.? @
Telefono@ H
)H I
;I J
cmd 
. 

Parameters "
." #
AddWithValue# /
(/ 0
$str0 8
,8 9
obj: =
.= >
Estado> D
)D E
;E F
cmd 
. 

Parameters "
." #
Add# &
(& '
$str' 2
,2 3
	SqlDbType4 =
.= >
Int> A
)A B
.B C
	DirectionC L
=M N
ParameterDirectionO a
.a b
Outputb h
;h i
cmd 
. 

Parameters "
." #
Add# &
(& '
$str' 0
,0 1
	SqlDbType2 ;
.; <
VarChar< C
,C D
$numE H
)H I
.I J
	DirectionJ S
=T U
ParameterDirectionV h
.h i
Outputi o
;o p
cmd 
. 
CommandType #
=$ %
CommandType& 1
.1 2
StoredProcedure2 A
;A B
	oconexion   
.   
Open   "
(  " #
)  # $
;  $ %
cmd"" 
."" 
ExecuteNonQuery"" '
(""' (
)""( )
;"") *
	Respuesta$$ 
=$$ 
Convert$$  '
.$$' (
	ToBoolean$$( 1
($$1 2
cmd$$2 5
.$$5 6

Parameters$$6 @
[$$@ A
$str$$A L
]$$L M
.$$M N
Value$$N S
)$$S T
;$$T U
Mensaje%% 
=%% 
cmd%% !
.%%! "

Parameters%%" ,
[%%, -
$str%%- 6
]%%6 7
.%%7 8
Value%%8 =
.%%= >
ToString%%> F
(%%F G
)%%G H
;%%H I
}&& 
}'' 
catch(( 
((( 
	Exception(( 
ex(( 
)((  
{)) 
	Respuesta** 
=** 
false** !
;**! "
Mensaje++ 
=++ 
ex++ 
.++ 
Message++ $
;++$ %
},, 
return.. 
	Respuesta.. 
;.. 
}// 	
public11 
bool11 
Eliminar11 
(11 
Cliente11 $
obj11% (
,11( )
out11* -
string11. 4
Mensaje115 <
)11< =
{22 	
bool33 
	Respuesta33 
=33 
false33 "
;33" #
Mensaje44 
=44 
String44 
.44 
Empty44 "
;44" #
try66 
{77 
using88 
(88 
SqlConnection88 $
	oconexion88% .
=88/ 0
new881 4
SqlConnection885 B
(88B C
Conexion88C K
.88K L
cadena88L R
)88R S
)88S T
{99 

SqlCommand:: 
cmd:: "
=::# $
new::% (

SqlCommand::) 3
(::3 4
$str::4 f
,::f g
	oconexion::h q
)::q r
;::r s
cmd;; 
.;; 

Parameters;; "
.;;" #
AddWithValue;;# /
(;;/ 0
$str;;0 ;
,;;; <
obj;;= @
.;;@ A
Id;;A C
);;C D
;;;D E
cmd<< 
.<< 
CommandType<< #
=<<$ %
CommandType<<& 1
.<<1 2
Text<<2 6
;<<6 7
	oconexion== 
.== 
Open== "
(==" #
)==# $
;==$ %
	Respuesta?? 
=?? 
cmd??  #
.??# $
ExecuteNonQuery??$ 3
(??3 4
)??4 5
>??6 7
$num??8 9
???: ;
true??< @
:??A B
false??C H
;??H I
}@@ 
}AA 
catchBB 
(BB 
	ExceptionBB 
exBB 
)BB  
{CC 
	RespuestaDD 
=DD 
falseDD !
;DD! "
MensajeEE 
=EE 
exEE 
.EE 
MessageEE $
;EE$ %
}FF 
returnHH 
	RespuestaHH 
;HH 
}II 	
publicKK 
ListKK 
<KK 
ClienteKK 
>KK 
ListarKK #
(KK# $
)KK$ %
{LL 	
ListMM 
<MM 
ClienteMM 
>MM 
listaMM 
=MM  !
newMM" %
ListMM& *
<MM* +
ClienteMM+ 2
>MM2 3
(MM3 4
)MM4 5
;MM5 6
usingOO 
(OO 
SqlConnectionOO  
	oconexionOO! *
=OO+ ,
newOO- 0
SqlConnectionOO1 >
(OO> ?
ConexionOO? G
.OOG H
cadenaOOH N
)OON O
)OOO P
{PP 
tryQQ 
{RR 
StringBuilderSS !
querySS" '
=SS( )
newSS* -
StringBuilderSS. ;
(SS; <
)SS< =
;SS= >
queryTT 
.TT 

AppendLineTT $
(TT$ %
$strTT% t
)TTt u
;TTu v

SqlCommandUU 
cmdUU "
=UU# $
newUU% (

SqlCommandUU) 3
(UU3 4
queryUU4 9
.UU9 :
ToStringUU: B
(UUB C
)UUC D
,UUD E
	oconexionUUF O
)UUO P
;UUP Q
cmdVV 
.VV 
CommandTypeVV #
=VV$ %
CommandTypeVV& 1
.VV1 2
TextVV2 6
;VV6 7
	oconexionWW 
.WW 
OpenWW "
(WW" #
)WW# $
;WW$ %
usingYY 
(YY 
SqlDataReaderYY (
drYY) +
=YY, -
cmdYY. 1
.YY1 2
ExecuteReaderYY2 ?
(YY? @
)YY@ A
)YYA B
{ZZ 
while[[ 
([[ 
dr[[ !
.[[! "
Read[[" &
([[& '
)[[' (
)[[( )
{\\ 
lista]] !
.]]! "
Add]]" %
(]]% &
new]]& )
Cliente]]* 1
(]]1 2
)]]2 3
{^^ 
Id__  "
=__# $
Convert__% ,
.__, -
ToInt32__- 4
(__4 5
dr__5 7
[__7 8
$str__8 C
]__C D
)__D E
,__E F
	Documento``  )
=``* +
dr``, .
[``. /
$str``/ :
]``: ;
.``; <
ToString``< D
(``D E
)``E F
,``F G
NombreCompletoaa  .
=aa/ 0
draa1 3
[aa3 4
$straa4 D
]aaD E
.aaE F
ToStringaaF N
(aaN O
)aaO P
,aaP Q
Correobb  &
=bb' (
drbb) +
[bb+ ,
$strbb, 4
]bb4 5
.bb5 6
ToStringbb6 >
(bb> ?
)bb? @
,bb@ A
Telefonocc  (
=cc) *
drcc+ -
[cc- .
$strcc. 8
]cc8 9
.cc9 :
ToStringcc: B
(ccB C
)ccC D
,ccD E
Estadodd  &
=dd' (
Convertdd) 0
.dd0 1
	ToBooleandd1 :
(dd: ;
drdd; =
[dd= >
$strdd> F
]ddF G
)ddG H
,ddH I
}ee 
)ee 
;ee 
}ff 
}gg 
}ii 
catchjj 
(jj 
	Exceptionjj  
exjj! #
)jj# $
{kk 
listamm 
=mm 
newmm 
Listmm  $
<mm$ %
Clientemm% ,
>mm, -
(mm- .
)mm. /
;mm/ 0
}nn 
}oo 
returnpp 
listapp 
;pp 
}qq 	
publicss 
intss 
	Registrarss 
(ss 
Clientess $
objss% (
,ss( )
outss* -
stringss. 4
Mensajess5 <
)ss< =
{tt 	
intuu 
idClientegeneradouu !
=uu" #
$numuu$ %
;uu% &
Mensajevv 
=vv 
Stringvv 
.vv 
Emptyvv "
;vv" #
tryxx 
{yy 
usingzz 
(zz 
SqlConnectionzz $
	oconexionzz% .
=zz/ 0
newzz1 4
SqlConnectionzz5 B
(zzB C
ConexionzzC K
.zzK L
cadenazzL R
)zzR S
)zzS T
{{{ 

SqlCommand|| 
cmd|| "
=||# $
new||% (

SqlCommand||) 3
(||3 4
$str||4 I
,||I J
	oconexion||K T
)||T U
;||U V
cmd}} 
.}} 

Parameters}} "
.}}" #
AddWithValue}}# /
(}}/ 0
$str}}0 ;
,}}; <
obj}}= @
.}}@ A
	Documento}}A J
)}}J K
;}}K L
cmd~~ 
.~~ 

Parameters~~ "
.~~" #
AddWithValue~~# /
(~~/ 0
$str~~0 @
,~~@ A
obj~~B E
.~~E F
NombreCompleto~~F T
)~~T U
;~~U V
cmd 
. 

Parameters "
." #
AddWithValue# /
(/ 0
$str0 8
,8 9
obj: =
.= >
Correo> D
)D E
;E F
cmd
ÄÄ 
.
ÄÄ 

Parameters
ÄÄ "
.
ÄÄ" #
AddWithValue
ÄÄ# /
(
ÄÄ/ 0
$str
ÄÄ0 :
,
ÄÄ: ;
obj
ÄÄ< ?
.
ÄÄ? @
Telefono
ÄÄ@ H
)
ÄÄH I
;
ÄÄI J
cmd
ÅÅ 
.
ÅÅ 

Parameters
ÅÅ "
.
ÅÅ" #
AddWithValue
ÅÅ# /
(
ÅÅ/ 0
$str
ÅÅ0 8
,
ÅÅ8 9
obj
ÅÅ: =
.
ÅÅ= >
Estado
ÅÅ> D
)
ÅÅD E
;
ÅÅE F
cmd
ÇÇ 
.
ÇÇ 

Parameters
ÇÇ "
.
ÇÇ" #
Add
ÇÇ# &
(
ÇÇ& '
$str
ÇÇ' 2
,
ÇÇ2 3
	SqlDbType
ÇÇ4 =
.
ÇÇ= >
Int
ÇÇ> A
)
ÇÇA B
.
ÇÇB C
	Direction
ÇÇC L
=
ÇÇM N 
ParameterDirection
ÇÇO a
.
ÇÇa b
Output
ÇÇb h
;
ÇÇh i
cmd
ÉÉ 
.
ÉÉ 

Parameters
ÉÉ "
.
ÉÉ" #
Add
ÉÉ# &
(
ÉÉ& '
$str
ÉÉ' 0
,
ÉÉ0 1
	SqlDbType
ÉÉ2 ;
.
ÉÉ; <
VarChar
ÉÉ< C
,
ÉÉC D
$num
ÉÉE H
)
ÉÉH I
.
ÉÉI J
	Direction
ÉÉJ S
=
ÉÉT U 
ParameterDirection
ÉÉV h
.
ÉÉh i
Output
ÉÉi o
;
ÉÉo p
cmd
ÑÑ 
.
ÑÑ 
CommandType
ÑÑ #
=
ÑÑ$ %
CommandType
ÑÑ& 1
.
ÑÑ1 2
StoredProcedure
ÑÑ2 A
;
ÑÑA B
	oconexion
ÖÖ 
.
ÖÖ 
Open
ÖÖ "
(
ÖÖ" #
)
ÖÖ# $
;
ÖÖ$ %
cmd
áá 
.
áá 
ExecuteNonQuery
áá '
(
áá' (
)
áá( )
;
áá) *
idClientegenerado
ââ %
=
ââ& '
Convert
ââ( /
.
ââ/ 0
ToInt32
ââ0 7
(
ââ7 8
cmd
ââ8 ;
.
ââ; <

Parameters
ââ< F
[
ââF G
$str
ââG R
]
ââR S
.
ââS T
Value
ââT Y
)
ââY Z
;
ââZ [
Mensaje
ää 
=
ää 
cmd
ää !
.
ää! "

Parameters
ää" ,
[
ää, -
$str
ää- 6
]
ää6 7
.
ää7 8
Value
ää8 =
.
ää= >
ToString
ää> F
(
ääF G
)
ääG H
;
ääH I
}
ãã 
}
åå 
catch
çç 
(
çç 
	Exception
çç 
ex
çç 
)
çç  
{
éé 
idClientegenerado
èè !
=
èè" #
$num
èè$ %
;
èè% &
Mensaje
êê 
=
êê 
ex
êê 
.
êê 
Message
êê $
;
êê$ %
}
ëë 
return
ìì 
idClientegenerado
ìì $
;
ìì$ %
}
îî 	
}
ïï 
}ññ ˇÜ
pD:\Ingenier√≠a de Sistemas\Ingenier√≠a de Software II\SistemaDeVentaPassionDrummers\Datos\RepositorioProducto.cs
	namespace		 	
Datos		
 
{

 
public 

class 
RepositorioProducto $
:% &
ICrudBaseDatos' 5
<5 6
Producto6 >
>> ?
{ 
public 
bool 
Editar 
( 
Producto #
obj$ '
,' (
out) ,
string- 3
Mensaje4 ;
); <
{ 	
bool 
	Respuesta 
= 
false "
;" #
Mensaje 
= 
String 
. 
Empty "
;" #
try 
{ 
using 
( 
SqlConnection $
	oconexion% .
=/ 0
new1 4
SqlConnection5 B
(B C
ConexionC K
.K L
cadenaL R
)R S
)S T
{ 

SqlCommand 
cmd "
=# $
new% (

SqlCommand) 3
(3 4
$str4 J
,J K
	oconexionL U
)U V
;V W
cmd 
. 

Parameters "
." #
AddWithValue# /
(/ 0
$str0 <
,< =
obj> A
.A B

IdProductoB L
)L M
;M N
cmd 
. 

Parameters "
." #
AddWithValue# /
(/ 0
$str0 8
,8 9
obj: =
.= >
Codigo> D
)D E
;E F
cmd 
. 

Parameters "
." #
AddWithValue# /
(/ 0
$str0 8
,8 9
obj: =
.= >
Nombre> D
)D E
;E F
cmd 
. 

Parameters "
." #
AddWithValue# /
(/ 0
$str0 =
,= >
obj? B
.B C
DescripcionC N
)N O
;O P
cmd 
. 

Parameters "
." #
AddWithValue# /
(/ 0
$str0 =
,= >
obj? B
.B C

oCategoriaC M
.M N
IdCategoriaN Y
)Y Z
;Z [
cmd 
. 

Parameters "
." #
AddWithValue# /
(/ 0
$str0 8
,8 9
obj: =
.= >
Estado> D
)D E
;E F
cmd 
. 

Parameters "
." #
Add# &
(& '
$str' 2
,2 3
	SqlDbType4 =
.= >
Int> A
)A B
.B C
	DirectionC L
=M N
ParameterDirectionO a
.a b
Outputb h
;h i
cmd 
. 

Parameters "
." #
Add# &
(& '
$str' 0
,0 1
	SqlDbType2 ;
.; <
VarChar< C
,C D
$numE H
)H I
.I J
	DirectionJ S
=T U
ParameterDirectionV h
.h i
Outputi o
;o p
cmd 
. 
CommandType #
=$ %
CommandType& 1
.1 2
StoredProcedure2 A
;A B
	oconexion   
.   
Open   "
(  " #
)  # $
;  $ %
cmd"" 
."" 
ExecuteNonQuery"" '
(""' (
)""( )
;"") *
	Respuesta$$ 
=$$ 
Convert$$  '
.$$' (
	ToBoolean$$( 1
($$1 2
cmd$$2 5
.$$5 6

Parameters$$6 @
[$$@ A
$str$$A L
]$$L M
.$$M N
Value$$N S
)$$S T
;$$T U
Mensaje%% 
=%% 
cmd%% !
.%%! "

Parameters%%" ,
[%%, -
$str%%- 6
]%%6 7
.%%7 8
Value%%8 =
.%%= >
ToString%%> F
(%%F G
)%%G H
;%%H I
}&& 
}'' 
catch(( 
((( 
	Exception(( 
ex(( 
)((  
{)) 
	Respuesta** 
=** 
false** !
;**! "
Mensaje++ 
=++ 
ex++ 
.++ 
Message++ $
;++$ %
},, 
return.. 
	Respuesta.. 
;.. 
}// 	
public11 
bool11 
Eliminar11 
(11 
Producto11 %
obj11& )
,11) *
out11+ .
string11/ 5
Mensaje116 =
)11= >
{22 	
bool33 
	Respuesta33 
=33 
false33 "
;33" #
Mensaje44 
=44 
String44 
.44 
Empty44 "
;44" #
try66 
{77 
using88 
(88 
SqlConnection88 $
	oconexion88% .
=88/ 0
new881 4
SqlConnection885 B
(88B C
Conexion88C K
.88K L
cadena88L R
)88R S
)88S T
{99 

SqlCommand:: 
cmd:: "
=::# $
new::% (

SqlCommand::) 3
(::3 4
$str::4 H
,::H I
	oconexion::J S
)::S T
;::T U
cmd;; 
.;; 

Parameters;; "
.;;" #
AddWithValue;;# /
(;;/ 0
$str;;0 <
,;;< =
obj;;> A
.;;A B

IdProducto;;B L
);;L M
;;;M N
cmd<< 
.<< 

Parameters<< "
.<<" #
Add<<# &
(<<& '
$str<<' 2
,<<2 3
	SqlDbType<<4 =
.<<= >
Int<<> A
)<<A B
.<<B C
	Direction<<C L
=<<M N
ParameterDirection<<O a
.<<a b
Output<<b h
;<<h i
cmd== 
.== 

Parameters== "
.==" #
Add==# &
(==& '
$str==' 0
,==0 1
	SqlDbType==2 ;
.==; <
VarChar==< C
,==C D
$num==E H
)==H I
.==I J
	Direction==J S
===T U
ParameterDirection==V h
.==h i
Output==i o
;==o p
cmd>> 
.>> 
CommandType>> #
=>>$ %
CommandType>>& 1
.>>1 2
StoredProcedure>>2 A
;>>A B
	oconexion?? 
.?? 
Open?? "
(??" #
)??# $
;??$ %
cmdAA 
.AA 
ExecuteNonQueryAA '
(AA' (
)AA( )
;AA) *
	RespuestaCC 
=CC 
ConvertCC  '
.CC' (
	ToBooleanCC( 1
(CC1 2
cmdCC2 5
.CC5 6

ParametersCC6 @
[CC@ A
$strCCA L
]CCL M
.CCM N
ValueCCN S
)CCS T
;CCT U
MensajeDD 
=DD 
cmdDD !
.DD! "

ParametersDD" ,
[DD, -
$strDD- 6
]DD6 7
.DD7 8
ValueDD8 =
.DD= >
ToStringDD> F
(DDF G
)DDG H
;DDH I
}EE 
}FF 
catchGG 
(GG 
	ExceptionGG 
exGG 
)GG  
{HH 
	RespuestaII 
=II 
falseII !
;II! "
MensajeJJ 
=JJ 
exJJ 
.JJ 
MessageJJ $
;JJ$ %
}KK 
returnMM 
	RespuestaMM 
;MM 
}NN 	
publicPP 
ListPP 
<PP 
ProductoPP 
>PP 
ListarPP $
(PP$ %
)PP% &
{QQ 	
ListRR 
<RR 
ProductoRR 
>RR 
listaRR  
=RR! "
newRR# &
ListRR' +
<RR+ ,
ProductoRR, 4
>RR4 5
(RR5 6
)RR6 7
;RR7 8
usingTT 
(TT 
SqlConnectionTT  
	oconexionTT! *
=TT+ ,
newTT- 0
SqlConnectionTT1 >
(TT> ?
ConexionTT? G
.TTG H
cadenaTTH N
)TTN O
)TTO P
{UU 
tryVV 
{WW 
StringBuilderXX !
queryXX" '
=XX( )
newXX* -
StringBuilderXX. ;
(XX; <
)XX< =
;XX= >
queryYY 
.YY 

AppendLineYY $
(YY$ %
$str	YY% «
)
YY« »
;
YY» …
queryZZ 
.ZZ 

AppendLineZZ $
(ZZ$ %
$strZZ% ^
)ZZ^ _
;ZZ_ `

SqlCommand\\ 
cmd\\ "
=\\# $
new\\% (

SqlCommand\\) 3
(\\3 4
query\\4 9
.\\9 :
ToString\\: B
(\\B C
)\\C D
,\\D E
	oconexion\\F O
)\\O P
;\\P Q
cmd]] 
.]] 
CommandType]] #
=]]$ %
CommandType]]& 1
.]]1 2
Text]]2 6
;]]6 7
	oconexion^^ 
.^^ 
Open^^ "
(^^" #
)^^# $
;^^$ %
using`` 
(`` 
SqlDataReader`` (
dr``) +
=``, -
cmd``. 1
.``1 2
ExecuteReader``2 ?
(``? @
)``@ A
)``A B
{aa 
whilebb 
(bb 
drbb !
.bb! "
Readbb" &
(bb& '
)bb' (
)bb( )
{cc 
listadd !
.dd! "
Adddd" %
(dd% &
newdd& )
Productodd* 2
(dd2 3
)dd3 4
{ee 

IdProductoff  *
=ff+ ,
Convertff- 4
.ff4 5
ToInt32ff5 <
(ff< =
drff= ?
[ff? @
$strff@ L
]ffL M
)ffM N
,ffN O
Codigogg  &
=gg' (
drgg) +
[gg+ ,
$strgg, 4
]gg4 5
.gg5 6
ToStringgg6 >
(gg> ?
)gg? @
,gg@ A
Nombrehh  &
=hh' (
drhh) +
[hh+ ,
$strhh, 4
]hh4 5
.hh5 6
ToStringhh6 >
(hh> ?
)hh? @
,hh@ A
Descripcionii  +
=ii, -
drii. 0
[ii0 1
$strii1 >
]ii> ?
.ii? @
ToStringii@ H
(iiH I
)iiI J
,iiJ K

oCategoriajj  *
=jj+ ,
newjj- 0
	Categoriajj1 :
(jj: ;
)jj; <
{jj= >
IdCategoriajj? J
=jjK L
ConvertjjM T
.jjT U
ToInt32jjU \
(jj\ ]
drjj] _
[jj_ `
$strjj` m
]jjm n
)jjn o
,jjo p
Descripcionjjq |
=jj} ~
dr	jj Å
[
jjÅ Ç
$str
jjÇ ò
]
jjò ô
.
jjô ö
ToString
jjö ¢
(
jj¢ £
)
jj£ §
}
jj• ¶
,
jj¶ ß
Stockkk  %
=kk& '
Convertkk( /
.kk/ 0
ToInt32kk0 7
(kk7 8
drkk8 :
[kk: ;
$strkk; B
]kkB C
.kkC D
ToStringkkD L
(kkL M
)kkM N
)kkN O
,kkO P
PrecioComprall  ,
=ll- .
Convertll/ 6
.ll6 7
	ToDecimalll7 @
(ll@ A
drllA C
[llC D
$strllD R
]llR S
.llS T
ToStringllT \
(ll\ ]
)ll] ^
)ll^ _
,ll_ `
PrecioVentamm  +
=mm, -
Convertmm. 5
.mm5 6
	ToDecimalmm6 ?
(mm? @
drmm@ B
[mmB C
$strmmC P
]mmP Q
.mmQ R
ToStringmmR Z
(mmZ [
)mm[ \
)mm\ ]
,mm] ^
Estadonn  &
=nn' (
Convertnn) 0
.nn0 1
	ToBooleannn1 :
(nn: ;
drnn; =
[nn= >
$strnn> F
]nnF G
)nnG H
}oo 
)oo 
;oo 
}pp 
}qq 
}ss 
catchtt 
(tt 
	Exceptiontt  
extt! #
)tt# $
{uu 
listaww 
=ww 
newww 
Listww  $
<ww$ %
Productoww% -
>ww- .
(ww. /
)ww/ 0
;ww0 1
}xx 
}yy 
returnzz 
listazz 
;zz 
}{{ 	
public}} 
int}} 
	Registrar}} 
(}} 
Producto}} %
obj}}& )
,}}) *
out}}+ .
string}}/ 5
Mensaje}}6 =
)}}= >
{~~ 	
int 
idProductogenerado "
=# $
$num% &
;& '
Mensaje
ÄÄ 
=
ÄÄ 
String
ÄÄ 
.
ÄÄ 
Empty
ÄÄ "
;
ÄÄ" #
try
ÇÇ 
{
ÉÉ 
using
ÑÑ 
(
ÑÑ 
SqlConnection
ÑÑ $
	oconexion
ÑÑ% .
=
ÑÑ/ 0
new
ÑÑ1 4
SqlConnection
ÑÑ5 B
(
ÑÑB C
Conexion
ÑÑC K
.
ÑÑK L
cadena
ÑÑL R
)
ÑÑR S
)
ÑÑS T
{
ÖÖ 

SqlCommand
ÜÜ 
cmd
ÜÜ "
=
ÜÜ# $
new
ÜÜ% (

SqlCommand
ÜÜ) 3
(
ÜÜ3 4
$str
ÜÜ4 J
,
ÜÜJ K
	oconexion
ÜÜL U
)
ÜÜU V
;
ÜÜV W
cmd
áá 
.
áá 

Parameters
áá "
.
áá" #
AddWithValue
áá# /
(
áá/ 0
$str
áá0 8
,
áá8 9
obj
áá: =
.
áá= >
Codigo
áá> D
)
ááD E
;
ááE F
cmd
àà 
.
àà 

Parameters
àà "
.
àà" #
AddWithValue
àà# /
(
àà/ 0
$str
àà0 8
,
àà8 9
obj
àà: =
.
àà= >
Nombre
àà> D
)
ààD E
;
ààE F
cmd
ââ 
.
ââ 

Parameters
ââ "
.
ââ" #
AddWithValue
ââ# /
(
ââ/ 0
$str
ââ0 =
,
ââ= >
obj
ââ? B
.
ââB C
Descripcion
ââC N
)
ââN O
;
ââO P
cmd
ää 
.
ää 

Parameters
ää "
.
ää" #
AddWithValue
ää# /
(
ää/ 0
$str
ää0 =
,
ää= >
obj
ää? B
.
ääB C

oCategoria
ääC M
.
ääM N
IdCategoria
ääN Y
)
ääY Z
;
ääZ [
cmd
ãã 
.
ãã 

Parameters
ãã "
.
ãã" #
AddWithValue
ãã# /
(
ãã/ 0
$str
ãã0 8
,
ãã8 9
obj
ãã: =
.
ãã= >
Estado
ãã> D
)
ããD E
;
ããE F
cmd
åå 
.
åå 

Parameters
åå "
.
åå" #
Add
åå# &
(
åå& '
$str
åå' 2
,
åå2 3
	SqlDbType
åå4 =
.
åå= >
Int
åå> A
)
ååA B
.
ååB C
	Direction
ååC L
=
ååM N 
ParameterDirection
ååO a
.
ååa b
Output
ååb h
;
ååh i
cmd
çç 
.
çç 

Parameters
çç "
.
çç" #
Add
çç# &
(
çç& '
$str
çç' 0
,
çç0 1
	SqlDbType
çç2 ;
.
çç; <
VarChar
çç< C
,
ççC D
$num
ççE H
)
ççH I
.
ççI J
	Direction
ççJ S
=
ççT U 
ParameterDirection
ççV h
.
ççh i
Output
ççi o
;
çço p
cmd
éé 
.
éé 
CommandType
éé #
=
éé$ %
CommandType
éé& 1
.
éé1 2
StoredProcedure
éé2 A
;
ééA B
	oconexion
èè 
.
èè 
Open
èè "
(
èè" #
)
èè# $
;
èè$ %
cmd
ëë 
.
ëë 
ExecuteNonQuery
ëë '
(
ëë' (
)
ëë( )
;
ëë) * 
idProductogenerado
ìì &
=
ìì' (
Convert
ìì) 0
.
ìì0 1
ToInt32
ìì1 8
(
ìì8 9
cmd
ìì9 <
.
ìì< =

Parameters
ìì= G
[
ììG H
$str
ììH S
]
ììS T
.
ììT U
Value
ììU Z
)
ììZ [
;
ìì[ \
Mensaje
îî 
=
îî 
cmd
îî !
.
îî! "

Parameters
îî" ,
[
îî, -
$str
îî- 6
]
îî6 7
.
îî7 8
Value
îî8 =
.
îî= >
ToString
îî> F
(
îîF G
)
îîG H
;
îîH I
}
ïï 
}
ññ 
catch
óó 
(
óó 
	Exception
óó 
ex
óó 
)
óó  
{
òò  
idProductogenerado
ôô "
=
ôô# $
$num
ôô% &
;
ôô& '
Mensaje
öö 
=
öö 
ex
öö 
.
öö 
Message
öö $
;
öö$ %
}
õõ 
return
ùù  
idProductogenerado
ùù %
;
ùù% &
}
ûû 	
}
üü 
}†† á|
qD:\Ingenier√≠a de Sistemas\Ingenier√≠a de Software II\SistemaDeVentaPassionDrummers\Datos\RepositorioProveedor.cs
	namespace		 	
Datos		
 
{

 
public 

class  
RepositorioProveedor %
:& '
ICrudBaseDatos( 6
<6 7
	Proveedor7 @
>@ A
{ 
public 
bool 
Editar 
( 
	Proveedor $
obj% (
,( )
out* -
string. 4
Mensaje5 <
)< =
{ 	
bool 
	Respuesta 
= 
false "
;" #
Mensaje 
= 
String 
. 
Empty "
;" #
try 
{ 
using 
( 
SqlConnection $
	oconexion% .
=/ 0
new1 4
SqlConnection5 B
(B C
ConexionC K
.K L
cadenaL R
)R S
)S T
{ 

SqlCommand 
cmd "
=# $
new% (

SqlCommand) 3
(3 4
$str4 K
,K L
	oconexionM V
)V W
;W X
cmd 
. 

Parameters "
." #
AddWithValue# /
(/ 0
$str0 =
,= >
obj? B
.B C
IdC E
)E F
;F G
cmd 
. 

Parameters "
." #
AddWithValue# /
(/ 0
$str0 ;
,; <
obj= @
.@ A
	DocumentoA J
)J K
;K L
cmd 
. 

Parameters "
." #
AddWithValue# /
(/ 0
$str0 =
,= >
obj? B
.B C
RazonSocialC N
)N O
;O P
cmd 
. 

Parameters "
." #
AddWithValue# /
(/ 0
$str0 8
,8 9
obj: =
.= >
Correo> D
)D E
;E F
cmd 
. 

Parameters "
." #
AddWithValue# /
(/ 0
$str0 :
,: ;
obj< ?
.? @
Telefono@ H
)H I
;I J
cmd 
. 

Parameters "
." #
AddWithValue# /
(/ 0
$str0 8
,8 9
obj: =
.= >
Estado> D
)D E
;E F
cmd 
. 

Parameters "
." #
Add# &
(& '
$str' 2
,2 3
	SqlDbType4 =
.= >
Int> A
)A B
.B C
	DirectionC L
=M N
ParameterDirectionO a
.a b
Outputb h
;h i
cmd 
. 

Parameters "
." #
Add# &
(& '
$str' 0
,0 1
	SqlDbType2 ;
.; <
VarChar< C
,C D
$numE H
)H I
.I J
	DirectionJ S
=T U
ParameterDirectionV h
.h i
Outputi o
;o p
cmd 
. 
CommandType #
=$ %
CommandType& 1
.1 2
StoredProcedure2 A
;A B
	oconexion   
.   
Open   "
(  " #
)  # $
;  $ %
cmd"" 
."" 
ExecuteNonQuery"" '
(""' (
)""( )
;"") *
	Respuesta$$ 
=$$ 
Convert$$  '
.$$' (
	ToBoolean$$( 1
($$1 2
cmd$$2 5
.$$5 6

Parameters$$6 @
[$$@ A
$str$$A L
]$$L M
.$$M N
Value$$N S
)$$S T
;$$T U
Mensaje%% 
=%% 
cmd%% !
.%%! "

Parameters%%" ,
[%%, -
$str%%- 6
]%%6 7
.%%7 8
Value%%8 =
.%%= >
ToString%%> F
(%%F G
)%%G H
;%%H I
}&& 
}'' 
catch(( 
((( 
	Exception(( 
ex(( 
)((  
{)) 
	Respuesta** 
=** 
false** !
;**! "
Mensaje++ 
=++ 
ex++ 
.++ 
Message++ $
;++$ %
},, 
return.. 
	Respuesta.. 
;.. 
}// 	
public11 
bool11 
Eliminar11 
(11 
	Proveedor11 &
obj11' *
,11* +
out11, /
string110 6
Mensaje117 >
)11> ?
{22 	
bool33 
	Respuesta33 
=33 
false33 "
;33" #
Mensaje44 
=44 
String44 
.44 
Empty44 "
;44" #
try66 
{77 
using88 
(88 
SqlConnection88 $
	oconexion88% .
=88/ 0
new881 4
SqlConnection885 B
(88B C
Conexion88C K
.88K L
cadena88L R
)88R S
)88S T
{99 

SqlCommand:: 
cmd:: "
=::# $
new::% (

SqlCommand::) 3
(::3 4
$str::4 J
,::J K
	oconexion::L U
)::U V
;::V W
cmd;; 
.;; 

Parameters;; "
.;;" #
AddWithValue;;# /
(;;/ 0
$str;;0 =
,;;= >
obj;;? B
.;;B C
Id;;C E
);;E F
;;;F G
cmd<< 
.<< 

Parameters<< "
.<<" #
Add<<# &
(<<& '
$str<<' 2
,<<2 3
	SqlDbType<<4 =
.<<= >
Int<<> A
)<<A B
.<<B C
	Direction<<C L
=<<M N
ParameterDirection<<O a
.<<a b
Output<<b h
;<<h i
cmd== 
.== 

Parameters== "
.==" #
Add==# &
(==& '
$str==' 0
,==0 1
	SqlDbType==2 ;
.==; <
VarChar==< C
,==C D
$num==E H
)==H I
.==I J
	Direction==J S
===T U
ParameterDirection==V h
.==h i
Output==i o
;==o p
cmd>> 
.>> 
CommandType>> #
=>>$ %
CommandType>>& 1
.>>1 2
StoredProcedure>>2 A
;>>A B
	oconexion?? 
.?? 
Open?? "
(??" #
)??# $
;??$ %
cmdAA 
.AA 
ExecuteNonQueryAA '
(AA' (
)AA( )
;AA) *
	RespuestaCC 
=CC 
ConvertCC  '
.CC' (
	ToBooleanCC( 1
(CC1 2
cmdCC2 5
.CC5 6

ParametersCC6 @
[CC@ A
$strCCA L
]CCL M
.CCM N
ValueCCN S
)CCS T
;CCT U
MensajeDD 
=DD 
cmdDD !
.DD! "

ParametersDD" ,
[DD, -
$strDD- 6
]DD6 7
.DD7 8
ValueDD8 =
.DD= >
ToStringDD> F
(DDF G
)DDG H
;DDH I
}EE 
}FF 
catchGG 
(GG 
	ExceptionGG 
exGG 
)GG  
{HH 
	RespuestaII 
=II 
falseII !
;II! "
MensajeJJ 
=JJ 
exJJ 
.JJ 
MessageJJ $
;JJ$ %
}KK 
returnMM 
	RespuestaMM 
;MM 
}NN 	
publicPP 
ListPP 
<PP 
	ProveedorPP 
>PP 
ListarPP %
(PP% &
)PP& '
{QQ 	
ListRR 
<RR 
	ProveedorRR 
>RR 
listaRR !
=RR" #
newRR$ '
ListRR( ,
<RR, -
	ProveedorRR- 6
>RR6 7
(RR7 8
)RR8 9
;RR9 :
usingTT 
(TT 
SqlConnectionTT  
	oconexionTT! *
=TT+ ,
newTT- 0
SqlConnectionTT1 >
(TT> ?
ConexionTT? G
.TTG H
cadenaTTH N
)TTN O
)TTO P
{UU 
tryVV 
{WW 
StringBuilderXX !
queryXX" '
=XX( )
newXX* -
StringBuilderXX. ;
(XX; <
)XX< =
;XX= >
queryYY 
.YY 

AppendLineYY $
(YY$ %
$strYY% u
)YYu v
;YYv w

SqlCommand[[ 
cmd[[ "
=[[# $
new[[% (

SqlCommand[[) 3
([[3 4
query[[4 9
.[[9 :
ToString[[: B
([[B C
)[[C D
,[[D E
	oconexion[[F O
)[[O P
;[[P Q
cmd\\ 
.\\ 
CommandType\\ #
=\\$ %
CommandType\\& 1
.\\1 2
Text\\2 6
;\\6 7
	oconexion]] 
.]] 
Open]] "
(]]" #
)]]# $
;]]$ %
using__ 
(__ 
SqlDataReader__ (
dr__) +
=__, -
cmd__. 1
.__1 2
ExecuteReader__2 ?
(__? @
)__@ A
)__A B
{`` 
whileaa 
(aa 
draa !
.aa! "
Readaa" &
(aa& '
)aa' (
)aa( )
{bb 
listacc !
.cc! "
Addcc" %
(cc% &
newcc& )
	Proveedorcc* 3
(cc3 4
)cc4 5
{dd 
Idee  "
=ee# $
Convertee% ,
.ee, -
ToInt32ee- 4
(ee4 5
dree5 7
[ee7 8
$stree8 E
]eeE F
)eeF G
,eeG H
	Documentoff  )
=ff* +
drff, .
[ff. /
$strff/ :
]ff: ;
.ff; <
ToStringff< D
(ffD E
)ffE F
,ffF G
RazonSocialgg  +
=gg, -
drgg. 0
[gg0 1
$strgg1 >
]gg> ?
.gg? @
ToStringgg@ H
(ggH I
)ggI J
,ggJ K
Correohh  &
=hh' (
drhh) +
[hh+ ,
$strhh, 4
]hh4 5
.hh5 6
ToStringhh6 >
(hh> ?
)hh? @
,hh@ A
Telefonoii  (
=ii) *
drii+ -
[ii- .
$strii. 8
]ii8 9
.ii9 :
ToStringii: B
(iiB C
)iiC D
,iiD E
Estadojj  &
=jj' (
Convertjj) 0
.jj0 1
	ToBooleanjj1 :
(jj: ;
drjj; =
[jj= >
$strjj> F
]jjF G
)jjG H
,jjH I
}kk 
)kk 
;kk 
}ll 
}mm 
}oo 
catchpp 
(pp 
	Exceptionpp  
expp! #
)pp# $
{qq 
listass 
=ss 
newss 
Listss  $
<ss$ %
	Proveedorss% .
>ss. /
(ss/ 0
)ss0 1
;ss1 2
}tt 
}uu 
returnvv 
listavv 
;vv 
}ww 	
publicyy 
intyy 
	Registraryy 
(yy 
	Proveedoryy &
objyy' *
,yy* +
outyy, /
stringyy0 6
Mensajeyy7 >
)yy> ?
{zz 	
int{{ 
idProveedorgenerado{{ #
={{$ %
$num{{& '
;{{' (
Mensaje|| 
=|| 
String|| 
.|| 
Empty|| "
;||" #
try~~ 
{ 
using
ÄÄ 
(
ÄÄ 
SqlConnection
ÄÄ $
	oconexion
ÄÄ% .
=
ÄÄ/ 0
new
ÄÄ1 4
SqlConnection
ÄÄ5 B
(
ÄÄB C
Conexion
ÄÄC K
.
ÄÄK L
cadena
ÄÄL R
)
ÄÄR S
)
ÄÄS T
{
ÅÅ 

SqlCommand
ÇÇ 
cmd
ÇÇ "
=
ÇÇ# $
new
ÇÇ% (

SqlCommand
ÇÇ) 3
(
ÇÇ3 4
$str
ÇÇ4 K
,
ÇÇK L
	oconexion
ÇÇM V
)
ÇÇV W
;
ÇÇW X
cmd
ÉÉ 
.
ÉÉ 

Parameters
ÉÉ "
.
ÉÉ" #
AddWithValue
ÉÉ# /
(
ÉÉ/ 0
$str
ÉÉ0 ;
,
ÉÉ; <
obj
ÉÉ= @
.
ÉÉ@ A
	Documento
ÉÉA J
)
ÉÉJ K
;
ÉÉK L
cmd
ÑÑ 
.
ÑÑ 

Parameters
ÑÑ "
.
ÑÑ" #
AddWithValue
ÑÑ# /
(
ÑÑ/ 0
$str
ÑÑ0 =
,
ÑÑ= >
obj
ÑÑ? B
.
ÑÑB C
RazonSocial
ÑÑC N
)
ÑÑN O
;
ÑÑO P
cmd
ÖÖ 
.
ÖÖ 

Parameters
ÖÖ "
.
ÖÖ" #
AddWithValue
ÖÖ# /
(
ÖÖ/ 0
$str
ÖÖ0 8
,
ÖÖ8 9
obj
ÖÖ: =
.
ÖÖ= >
Correo
ÖÖ> D
)
ÖÖD E
;
ÖÖE F
cmd
ÜÜ 
.
ÜÜ 

Parameters
ÜÜ "
.
ÜÜ" #
AddWithValue
ÜÜ# /
(
ÜÜ/ 0
$str
ÜÜ0 :
,
ÜÜ: ;
obj
ÜÜ< ?
.
ÜÜ? @
Telefono
ÜÜ@ H
)
ÜÜH I
;
ÜÜI J
cmd
áá 
.
áá 

Parameters
áá "
.
áá" #
AddWithValue
áá# /
(
áá/ 0
$str
áá0 8
,
áá8 9
obj
áá: =
.
áá= >
Estado
áá> D
)
ááD E
;
ááE F
cmd
àà 
.
àà 

Parameters
àà "
.
àà" #
Add
àà# &
(
àà& '
$str
àà' 2
,
àà2 3
	SqlDbType
àà4 =
.
àà= >
Int
àà> A
)
ààA B
.
ààB C
	Direction
ààC L
=
ààM N 
ParameterDirection
ààO a
.
ààa b
Output
ààb h
;
ààh i
cmd
ââ 
.
ââ 

Parameters
ââ "
.
ââ" #
Add
ââ# &
(
ââ& '
$str
ââ' 0
,
ââ0 1
	SqlDbType
ââ2 ;
.
ââ; <
VarChar
ââ< C
,
ââC D
$num
ââE H
)
ââH I
.
ââI J
	Direction
ââJ S
=
ââT U 
ParameterDirection
ââV h
.
ââh i
Output
ââi o
;
ââo p
cmd
ää 
.
ää 
CommandType
ää #
=
ää$ %
CommandType
ää& 1
.
ää1 2
StoredProcedure
ää2 A
;
ääA B
	oconexion
ãã 
.
ãã 
Open
ãã "
(
ãã" #
)
ãã# $
;
ãã$ %
cmd
çç 
.
çç 
ExecuteNonQuery
çç '
(
çç' (
)
çç( )
;
çç) *!
idProveedorgenerado
èè '
=
èè( )
Convert
èè* 1
.
èè1 2
ToInt32
èè2 9
(
èè9 :
cmd
èè: =
.
èè= >

Parameters
èè> H
[
èèH I
$str
èèI T
]
èèT U
.
èèU V
Value
èèV [
)
èè[ \
;
èè\ ]
Mensaje
êê 
=
êê 
cmd
êê !
.
êê! "

Parameters
êê" ,
[
êê, -
$str
êê- 6
]
êê6 7
.
êê7 8
Value
êê8 =
.
êê= >
ToString
êê> F
(
êêF G
)
êêG H
;
êêH I
}
ëë 
}
íí 
catch
ìì 
(
ìì 
	Exception
ìì 
ex
ìì 
)
ìì  
{
îî !
idProveedorgenerado
ïï #
=
ïï$ %
$num
ïï& '
;
ïï' (
Mensaje
ññ 
=
ññ 
ex
ññ 
.
ññ 
Message
ññ $
;
ññ$ %
}
óó 
return
ôô !
idProveedorgenerado
ôô &
;
ôô& '
}
öö 	
}
õõ 
}úú … 
kD:\Ingenier√≠a de Sistemas\Ingenier√≠a de Software II\SistemaDeVentaPassionDrummers\Datos\RepositorioRol.cs
	namespace		 	
Datos		
 
{

 
public 

class 
RepositorioRol 
:  !
ICrudBaseDatos" 0
<0 1
Rol1 4
>4 5
{ 
public 
bool 
Editar 
( 
Rol 
obj "
," #
out$ '
string( .
Mensaje/ 6
)6 7
{ 	
throw 
new #
NotImplementedException -
(- .
). /
;/ 0
} 	
public 
bool 
Eliminar 
( 
Rol  
obj! $
,$ %
out& )
string* 0
Mensaje1 8
)8 9
{ 	
throw 
new #
NotImplementedException -
(- .
). /
;/ 0
} 	
public 
List 
< 
Rol 
> 
Listar 
(  
)  !
{ 	
List 
< 
Rol 
> 
lista 
= 
new !
List" &
<& '
Rol' *
>* +
(+ ,
), -
;- .
using 
( 
SqlConnection  
	oconexion! *
=+ ,
new- 0
SqlConnection1 >
(> ?
Conexion? G
.G H
cadenaH N
)N O
)O P
{ 
try 
{ 
StringBuilder !
query" '
=( )
new* -
StringBuilder. ;
(; <
)< =
;= >
query   
.   

AppendLine   $
(  $ %
$str  % G
)  G H
;  H I

SqlCommand"" 
cmd"" "
=""# $
new""% (

SqlCommand"") 3
(""3 4
query""4 9
.""9 :
ToString"": B
(""B C
)""C D
,""D E
	oconexion""F O
)""O P
;""P Q
cmd## 
.## 
CommandType## #
=##$ %
CommandType##& 1
.##1 2
Text##2 6
;##6 7
	oconexion$$ 
.$$ 
Open$$ "
($$" #
)$$# $
;$$$ %
using&& 
(&& 
SqlDataReader&& (
dr&&) +
=&&, -
cmd&&. 1
.&&1 2
ExecuteReader&&2 ?
(&&? @
)&&@ A
)&&A B
{'' 
while(( 
((( 
dr(( !
.((! "
Read((" &
(((& '
)((' (
)((( )
{)) 
lista** !
.**! "
Add**" %
(**% &
new**& )
Rol*** -
(**- .
)**. /
{++ 
IdRol,,  %
=,,& '
Convert,,( /
.,,/ 0
ToInt32,,0 7
(,,7 8
dr,,8 :
[,,: ;
$str,,; B
],,B C
),,C D
,,,D E
Descripcion--  +
=--, -
dr--. 0
[--0 1
$str--1 =
]--= >
.--> ?
ToString--? G
(--G H
)--H I
}.. 
).. 
;.. 
}// 
}00 
}11 
catch22 
(22 
	Exception22  
ex22! #
)22# $
{33 
lista55 
=55 
new55 
List55  $
<55$ %
Rol55% (
>55( )
(55) *
)55* +
;55+ ,
}66 
}77 
return88 
lista88 
;88 
}99 	
public;; 
int;; 
	Registrar;; 
(;; 
Rol;;  
obj;;! $
,;;$ %
out;;& )
string;;* 0
Mensaje;;1 8
);;8 9
{<< 	
throw== 
new== #
NotImplementedException== -
(==- .
)==. /
;==/ 0
}>> 	
}?? 
}@@ àÖ
oD:\Ingenier√≠a de Sistemas\Ingenier√≠a de Software II\SistemaDeVentaPassionDrummers\Datos\RepositorioUsuario.cs
	namespace		 	
Datos		
 
{

 
public 

class 
RepositorioUsuario #
:$ %
ICrudBaseDatos& 4
<4 5
Usuario5 <
>< =
{ 
public 
bool 
Editar 
( 
Usuario "
obj# &
,& '
out( +
string, 2
Mensaje3 :
): ;
{ 	
bool 
	Respuesta 
= 
false "
;" #
Mensaje 
= 
String 
. 
Empty "
;" #
try 
{ 
using 
( 
SqlConnection $
	oconexion% .
=/ 0
new1 4
SqlConnection5 B
(B C
ConexionC K
.K L
cadenaL R
)R S
)S T
{ 

SqlCommand 
cmd "
=# $
new% (

SqlCommand) 3
(3 4
$str4 F
,F G
	oconexionH Q
)Q R
;R S
cmd 
. 

Parameters "
." #
AddWithValue# /
(/ 0
$str0 ;
,; <
obj= @
.@ A
IdA C
)C D
;D E
cmd 
. 

Parameters "
." #
AddWithValue# /
(/ 0
$str0 ;
,; <
obj= @
.@ A
	DocumentoA J
)J K
;K L
cmd 
. 

Parameters "
." #
AddWithValue# /
(/ 0
$str0 @
,@ A
objB E
.E F
NombreCompletoF T
)T U
;U V
cmd 
. 

Parameters "
." #
AddWithValue# /
(/ 0
$str0 8
,8 9
obj: =
.= >
Correo> D
)D E
;E F
cmd 
. 

Parameters "
." #
AddWithValue# /
(/ 0
$str0 7
,7 8
obj9 <
.< =
Clave= B
)B C
;C D
cmd 
. 

Parameters "
." #
AddWithValue# /
(/ 0
$str0 7
,7 8
obj9 <
.< =
oRol= A
.A B
IdRolB G
)G H
;H I
cmd 
. 

Parameters "
." #
AddWithValue# /
(/ 0
$str0 8
,8 9
obj: =
.= >
Estado> D
)D E
;E F
cmd 
. 

Parameters "
." #
Add# &
(& '
$str' 2
,2 3
	SqlDbType4 =
.= >
Int> A
)A B
.B C
	DirectionC L
=M N
ParameterDirectionO a
.a b
Outputb h
;h i
cmd 
. 

Parameters "
." #
Add# &
(& '
$str' 0
,0 1
	SqlDbType2 ;
.; <
VarChar< C
,C D
$numE H
)H I
.I J
	DirectionJ S
=T U
ParameterDirectionV h
.h i
Outputi o
;o p
cmd   
.   
CommandType   #
=  $ %
CommandType  & 1
.  1 2
StoredProcedure  2 A
;  A B
	oconexion!! 
.!! 
Open!! "
(!!" #
)!!# $
;!!$ %
cmd## 
.## 
ExecuteNonQuery## '
(##' (
)##( )
;##) *
	Respuesta%% 
=%% 
Convert%%  '
.%%' (
	ToBoolean%%( 1
(%%1 2
cmd%%2 5
.%%5 6

Parameters%%6 @
[%%@ A
$str%%A L
]%%L M
.%%M N
Value%%N S
)%%S T
;%%T U
Mensaje&& 
=&& 
cmd&& !
.&&! "

Parameters&&" ,
[&&, -
$str&&- 6
]&&6 7
.&&7 8
Value&&8 =
.&&= >
ToString&&> F
(&&F G
)&&G H
;&&H I
}'' 
}(( 
catch)) 
()) 
	Exception)) 
ex)) 
)))  
{** 
	Respuesta++ 
=++ 
false++ !
;++! "
Mensaje,, 
=,, 
ex,, 
.,, 
Message,, $
;,,$ %
}-- 
return// 
	Respuesta// 
;// 
}00 	
public22 
bool22 
Eliminar22 
(22 
Usuario22 $
obj22% (
,22( )
out22* -
string22. 4
Mensaje225 <
)22< =
{33 	
bool44 
	Respuesta44 
=44 
false44 "
;44" #
Mensaje55 
=55 
String55 
.55 
Empty55 "
;55" #
try77 
{88 
using99 
(99 
SqlConnection99 $
	oconexion99% .
=99/ 0
new991 4
SqlConnection995 B
(99B C
Conexion99C K
.99K L
cadena99L R
)99R S
)99S T
{:: 

SqlCommand;; 
cmd;; "
=;;# $
new;;% (

SqlCommand;;) 3
(;;3 4
$str;;4 H
,;;H I
	oconexion;;J S
);;S T
;;;T U
cmd<< 
.<< 

Parameters<< "
.<<" #
AddWithValue<<# /
(<</ 0
$str<<0 ;
,<<; <
obj<<= @
.<<@ A
Id<<A C
)<<C D
;<<D E
cmd== 
.== 

Parameters== "
.==" #
Add==# &
(==& '
$str==' 2
,==2 3
	SqlDbType==4 =
.=== >
Int==> A
)==A B
.==B C
	Direction==C L
===M N
ParameterDirection==O a
.==a b
Output==b h
;==h i
cmd>> 
.>> 

Parameters>> "
.>>" #
Add>># &
(>>& '
$str>>' 0
,>>0 1
	SqlDbType>>2 ;
.>>; <
VarChar>>< C
,>>C D
$num>>E H
)>>H I
.>>I J
	Direction>>J S
=>>T U
ParameterDirection>>V h
.>>h i
Output>>i o
;>>o p
cmd?? 
.?? 
CommandType?? #
=??$ %
CommandType??& 1
.??1 2
StoredProcedure??2 A
;??A B
	oconexion@@ 
.@@ 
Open@@ "
(@@" #
)@@# $
;@@$ %
cmdBB 
.BB 
ExecuteNonQueryBB '
(BB' (
)BB( )
;BB) *
	RespuestaDD 
=DD 
ConvertDD  '
.DD' (
	ToBooleanDD( 1
(DD1 2
cmdDD2 5
.DD5 6

ParametersDD6 @
[DD@ A
$strDDA L
]DDL M
.DDM N
ValueDDN S
)DDS T
;DDT U
MensajeEE 
=EE 
cmdEE !
.EE! "

ParametersEE" ,
[EE, -
$strEE- 6
]EE6 7
.EE7 8
ValueEE8 =
.EE= >
ToStringEE> F
(EEF G
)EEG H
;EEH I
}FF 
}GG 
catchHH 
(HH 
	ExceptionHH 
exHH 
)HH  
{II 
	RespuestaJJ 
=JJ 
falseJJ !
;JJ! "
MensajeKK 
=KK 
exKK 
.KK 
MessageKK $
;KK$ %
}LL 
returnNN 
	RespuestaNN 
;NN 
}OO 	
publicQQ 
ListQQ 
<QQ 
UsuarioQQ 
>QQ 
ListarQQ #
(QQ# $
)QQ$ %
{RR 	
ListSS 
<SS 
UsuarioSS 
>SS 
listaSS 
=SS  !
newSS" %
ListSS& *
<SS* +
UsuarioSS+ 2
>SS2 3
(SS3 4
)SS4 5
;SS5 6
usingUU 
(UU 
SqlConnectionUU  
	oconexionUU! *
=UU+ ,
newUU- 0
SqlConnectionUU1 >
(UU> ?
ConexionUU? G
.UUG H
cadenaUUH N
)UUN O
)UUO P
{VV 
tryWW 
{XX 
StringBuilderYY !
queryYY" '
=YY( )
newYY* -
StringBuilderYY. ;
(YY; <
)YY< =
;YY= >
queryZZ 
.ZZ 

AppendLineZZ $
(ZZ$ %
$str	ZZ% ñ
)
ZZñ ó
;
ZZó ò
query[[ 
.[[ 

AppendLine[[ $
([[$ %
$str[[% L
)[[L M
;[[M N

SqlCommand]] 
cmd]] "
=]]# $
new]]% (

SqlCommand]]) 3
(]]3 4
query]]4 9
.]]9 :
ToString]]: B
(]]B C
)]]C D
,]]D E
	oconexion]]F O
)]]O P
;]]P Q
cmd^^ 
.^^ 
CommandType^^ #
=^^$ %
CommandType^^& 1
.^^1 2
Text^^2 6
;^^6 7
	oconexion__ 
.__ 
Open__ "
(__" #
)__# $
;__$ %
usingaa 
(aa 
SqlDataReaderaa (
draa) +
=aa, -
cmdaa. 1
.aa1 2
ExecuteReaderaa2 ?
(aa? @
)aa@ A
)aaA B
{bb 
whilecc 
(cc 
drcc !
.cc! "
Readcc" &
(cc& '
)cc' (
)cc( )
{dd 
listaee !
.ee! "
Addee" %
(ee% &
newee& )
Usuarioee* 1
(ee1 2
)ee2 3
{ff 
Idgg  "
=gg# $
Convertgg% ,
.gg, -
ToInt32gg- 4
(gg4 5
drgg5 7
[gg7 8
$strgg8 C
]ggC D
)ggD E
,ggE F
	Documentohh  )
=hh* +
drhh, .
[hh. /
$strhh/ :
]hh: ;
.hh; <
ToStringhh< D
(hhD E
)hhE F
,hhF G
NombreCompletoii  .
=ii/ 0
drii1 3
[ii3 4
$strii4 D
]iiD E
.iiE F
ToStringiiF N
(iiN O
)iiO P
,iiP Q
Correojj  &
=jj' (
drjj) +
[jj+ ,
$strjj, 4
]jj4 5
.jj5 6
ToStringjj6 >
(jj> ?
)jj? @
,jj@ A
Clavekk  %
=kk& '
drkk( *
[kk* +
$strkk+ 2
]kk2 3
.kk3 4
ToStringkk4 <
(kk< =
)kk= >
,kk> ?
Estadoll  &
=ll' (
Convertll) 0
.ll0 1
	ToBooleanll1 :
(ll: ;
drll; =
[ll= >
$strll> F
]llF G
)llG H
,llH I
oRolmm  $
=mm% &
newmm' *
Rolmm+ .
(mm. /
)mm/ 0
{mm1 2
IdRolmm3 8
=mm9 :
Convertmm; B
.mmB C
ToInt32mmC J
(mmJ K
drmmK M
[mmM N
$strmmN U
]mmU V
)mmV W
,mmW X
DescripcionmmY d
=mme f
drmmg i
[mmi j
$strmmj v
]mmv w
.mmw x
ToString	mmx Ä
(
mmÄ Å
)
mmÅ Ç
}
mmÉ Ñ
}nn 
)nn 
;nn 
}oo 
}pp 
}rr 
catchss 
(ss 
	Exceptionss  
exss! #
)ss# $
{tt 
listavv 
=vv 
newvv 
Listvv  $
<vv$ %
Usuariovv% ,
>vv, -
(vv- .
)vv. /
;vv/ 0
}ww 
}xx 
returnyy 
listayy 
;yy 
}zz 	
public|| 
int|| 
	Registrar|| 
(|| 
Usuario|| $
obj||% (
,||( )
out||* -
string||. 4
Mensaje||5 <
)||< =
{}} 	
int~~ 
idusuariogenerado~~ !
=~~" #
$num~~$ %
;~~% &
Mensaje 
= 
String 
. 
Empty "
;" #
try
ÅÅ 
{
ÇÇ 
using
ÉÉ 
(
ÉÉ 
SqlConnection
ÉÉ $
	oconexion
ÉÉ% .
=
ÉÉ/ 0
new
ÉÉ1 4
SqlConnection
ÉÉ5 B
(
ÉÉB C
Conexion
ÉÉC K
.
ÉÉK L
cadena
ÉÉL R
)
ÉÉR S
)
ÉÉS T
{
ÑÑ 

SqlCommand
ÖÖ 
cmd
ÖÖ "
=
ÖÖ# $
new
ÖÖ% (

SqlCommand
ÖÖ) 3
(
ÖÖ3 4
$str
ÖÖ4 I
,
ÖÖI J
	oconexion
ÖÖK T
)
ÖÖT U
;
ÖÖU V
cmd
ÜÜ 
.
ÜÜ 

Parameters
ÜÜ "
.
ÜÜ" #
AddWithValue
ÜÜ# /
(
ÜÜ/ 0
$str
ÜÜ0 ;
,
ÜÜ; <
obj
ÜÜ= @
.
ÜÜ@ A
	Documento
ÜÜA J
)
ÜÜJ K
;
ÜÜK L
cmd
áá 
.
áá 

Parameters
áá "
.
áá" #
AddWithValue
áá# /
(
áá/ 0
$str
áá0 @
,
áá@ A
obj
ááB E
.
ááE F
NombreCompleto
ááF T
)
ááT U
;
ááU V
cmd
àà 
.
àà 

Parameters
àà "
.
àà" #
AddWithValue
àà# /
(
àà/ 0
$str
àà0 8
,
àà8 9
obj
àà: =
.
àà= >
Correo
àà> D
)
ààD E
;
ààE F
cmd
ââ 
.
ââ 

Parameters
ââ "
.
ââ" #
AddWithValue
ââ# /
(
ââ/ 0
$str
ââ0 7
,
ââ7 8
obj
ââ9 <
.
ââ< =
Clave
ââ= B
)
ââB C
;
ââC D
cmd
ää 
.
ää 

Parameters
ää "
.
ää" #
AddWithValue
ää# /
(
ää/ 0
$str
ää0 7
,
ää7 8
obj
ää9 <
.
ää< =
oRol
ää= A
.
ääA B
IdRol
ääB G
)
ääG H
;
ääH I
cmd
ãã 
.
ãã 

Parameters
ãã "
.
ãã" #
AddWithValue
ãã# /
(
ãã/ 0
$str
ãã0 8
,
ãã8 9
obj
ãã: =
.
ãã= >
Estado
ãã> D
)
ããD E
;
ããE F
cmd
åå 
.
åå 

Parameters
åå "
.
åå" #
Add
åå# &
(
åå& '
$str
åå' ;
,
åå; <
	SqlDbType
åå= F
.
ååF G
Int
ååG J
)
ååJ K
.
ååK L
	Direction
ååL U
=
ååV W 
ParameterDirection
ååX j
.
ååj k
Output
ååk q
;
ååq r
cmd
çç 
.
çç 

Parameters
çç "
.
çç" #
Add
çç# &
(
çç& '
$str
çç' 0
,
çç0 1
	SqlDbType
çç2 ;
.
çç; <
VarChar
çç< C
,
ççC D
$num
ççE H
)
ççH I
.
ççI J
	Direction
ççJ S
=
ççT U 
ParameterDirection
ççV h
.
ççh i
Output
ççi o
;
çço p
cmd
éé 
.
éé 
CommandType
éé #
=
éé$ %
CommandType
éé& 1
.
éé1 2
StoredProcedure
éé2 A
;
ééA B
	oconexion
èè 
.
èè 
Open
èè "
(
èè" #
)
èè# $
;
èè$ %
cmd
ëë 
.
ëë 
ExecuteNonQuery
ëë '
(
ëë' (
)
ëë( )
;
ëë) *
idusuariogenerado
ìì %
=
ìì& '
Convert
ìì( /
.
ìì/ 0
ToInt32
ìì0 7
(
ìì7 8
cmd
ìì8 ;
.
ìì; <

Parameters
ìì< F
[
ììF G
$str
ììG [
]
ìì[ \
.
ìì\ ]
Value
ìì] b
)
ììb c
;
ììc d
Mensaje
îî 
=
îî 
cmd
îî !
.
îî! "

Parameters
îî" ,
[
îî, -
$str
îî- 6
]
îî6 7
.
îî7 8
Value
îî8 =
.
îî= >
ToString
îî> F
(
îîF G
)
îîG H
;
îîH I
}
ïï 
}
ññ 
catch
óó 
(
óó 
	Exception
óó 
ex
óó 
)
óó  
{
òò 
idusuariogenerado
ôô !
=
ôô" #
$num
ôô$ %
;
ôô% &
Mensaje
öö 
=
öö 
ex
öö 
.
öö 
Message
öö $
;
öö$ %
}
õõ 
return
ùù 
idusuariogenerado
ùù $
;
ùù$ %
}
ûû 	
}
üü 
}†† 